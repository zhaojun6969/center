import{_ as s,L as o,T as e,a}from"./index-BrLNRVYc.js";import{al as t,z as i,A as n,B as r,L as l,W as d,P as c,K as u,ai as w,E as p,Q as f,O as m,a5 as g,aF as v,R as b,J as P,I as h,az as y,l as C,r as _,c as k,ae as S,n as I,f as D,aA as V,u as E}from"./vendor-zwaLhAD5.js";import{P as j,z as x,y as K,E as q,d as F,O as U}from"./elementPlus-C3N3Ediy.js";import"./utils-D5HVl94d.js";const z={class:"forgot-password-form"},A={class:"form-container"},B={class:"form-group"},H={class:"form-label"},L={class:"input-group"},O=["placeholder"],R=["disabled"],$={key:1,class:"loading-dots"},J={class:"form-group verification-group"},Q={class:"form-label"},T={class:"verification-code-input"},W=["onUpdate:modelValue","onInput","onKeydown"],G={class:"verification-hint"},M={class:"form-group"},N={class:"form-label"},X={class:"password-input-group"},Y=["type","placeholder"],Z={class:"form-group"},ss={class:"form-label"},os={class:"password-input-group"},es=["type","placeholder"],as=["disabled"],ts={key:1,class:"success-message"},is={class:"success-title"},ns={class:"success-description"};const rs=s({name:"ForgotPasswordForm",emits:["reset-success"],components:{View:K,Hide:x,Key:j},setup(s,{emit:e}){let a=new o;const{t:t}=y(),i=C({email:"",verificationCode:"",verificationDigits:["","","","","",""],newPassword:"",confirmPassword:"",showPassword:!1,showConfirmPassword:!1,isSubmitting:!1,isSendingCode:!1,showSuccess:!1,codeCountdown:0,countdownInterval:null}),n=_([]),r=k(()=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.email)),l=()=>i.email?!!r.value||(F.error(t("forgotPassword.email_invalid_error")),!1):(F.error(t("forgotPassword.email_empty_error")),!1),d=(s=60)=>{i.codeCountdown=s,i.countdownInterval=setInterval(()=>{i.codeCountdown>0?i.codeCountdown--:clearInterval(i.countdownInterval)},1e3)},c=k(()=>6===i.verificationDigits.join("").length&&i.newPassword.length>=6&&i.confirmPassword.length>=6&&i.newPassword===i.confirmPassword);return{...S(i),t:t,isEmailValid:r,canSubmit:c,verificationInputs:n,handleEmailInput:()=>{},handleSendCode:async()=>{if(console.log("1789273756@qq.com"),l()){i.isSendingCode=!0;try{console.log(a.sendEmailCode),a.sendEmailCode({email:i.email,purpose:"forgot-password"},()=>{d(),n.value[0]?.focus()})}catch(s){console.log(s)}finally{i.isSendingCode=!1}}},handleSubmit:async()=>{if(!l())return;const s=i.verificationDigits.join("");if(s&&6===s.length){i.isSubmitting=!0;try{a.confirmForgotPassword({email:i.email,emailCode:s,password:i.newPassword},()=>{e("reset-success",i.email)})}catch(o){}finally{i.isSubmitting=!1}}else F.error(t("forgotPassword.verification_code_empty_error"))},handleCodeInput:async(s,o)=>{const e=o.target.value.replace(/\D/g,"");e&&(i.verificationDigits[s]=e,i.verificationCode=i.verificationDigits.join(""),s<5&&e&&(await I(),n.value[s+1]?.focus()))},handleCodeKeydown:async(s,o)=>{"Backspace"===o.key&&!i.verificationDigits[s]&&s>0&&(await I(),n.value[s-1]?.focus())},handleCodePaste:async s=>{s.preventDefault();const o=s.clipboardData.getData("text").replace(/\D/g,"");if(6===o.length){for(let s=0;s<6;s++)i.verificationDigits[s]=o[s];i.verificationCode=o,await I(),n.value[5]?.focus()}},togglePasswordVisibility:()=>{i.showPassword=!i.showPassword},toggleConfirmPasswordVisibility:()=>{i.showConfirmPassword=!i.showConfirmPassword},cleanup:()=>{i.countdownInterval&&clearInterval(i.countdownInterval)}}},unmounted(){this.cleanup()}},[["render",function(s,o,e,a,y,C){const _=t("View"),k=t("Hide"),S=q,I=t("Key"),D=t("router-link");return n(),i("div",z,[r("div",A,[s.showSuccess?l("",!0):(n(),i("form",{key:0,onSubmit:o[8]||(o[8]=d((...s)=>a.handleSubmit&&a.handleSubmit(...s),["prevent"])),class:"form-content"},[r("div",B,[r("label",H,c(a.t("forgotPassword.email_label")),1),r("div",L,[u(r("input",{"onUpdate:modelValue":o[0]||(o[0]=o=>s.email=o),type:"email",class:"form-input",placeholder:a.t("forgotPassword.email_placeholder"),required:"",onInput:o[1]||(o[1]=(...s)=>a.handleEmailInput&&a.handleEmailInput(...s))},null,40,O),[[w,s.email]]),r("button",{type:"button",onClick:o[2]||(o[2]=(...s)=>a.handleSendCode&&a.handleSendCode(...s)),class:p(["send-code-button",{"countdown-active":s.codeCountdown>0}]),disabled:!a.isEmailValid||s.isSendingCode||s.codeCountdown>0},[s.codeCountdown>0?(n(),i(f,{key:0},[m(c(s.codeCountdown)+"s",1)],64)):s.isSendingCode?(n(),i("span",$,[...o[9]||(o[9]=[r("span",null,null,-1),r("span",null,null,-1),r("span",null,null,-1)])])):(n(),i(f,{key:2},[m(c(a.t("forgotPassword.send_code")),1)],64))],10,R)])]),r("div",J,[r("label",Q,c(a.t("forgotPassword.verification_code_label")),1),r("div",T,[(n(!0),i(f,null,g(s.verificationDigits,(e,t)=>u((n(),i("input",{key:t,ref_for:!0,ref:s=>a.verificationInputs[t]=s,"onUpdate:modelValue":o=>s.verificationDigits[t]=o,type:"text",class:"code-digit-input",maxlength:"1",pattern:"[0-9]",inputmode:"numeric",onInput:s=>a.handleCodeInput(t,s),onKeydown:s=>a.handleCodeKeydown(t,s),onPaste:o[3]||(o[3]=(...s)=>a.handleCodePaste&&a.handleCodePaste(...s)),required:""},null,40,W)),[[w,s.verificationDigits[t]]])),128))]),r("p",G,c(a.t("forgotPassword.verification_hint")),1)]),r("div",M,[r("label",N,c(a.t("forgotPassword.new_password_label")),1),r("div",X,[u(r("input",{"onUpdate:modelValue":o[4]||(o[4]=o=>s.newPassword=o),type:s.showPassword?"text":"password",class:"form-input",placeholder:a.t("forgotPassword.new_password_placeholder"),required:"",minlength:"6"},null,8,Y),[[v,s.newPassword]]),r("button",{type:"button",onClick:o[5]||(o[5]=(...s)=>a.togglePasswordVisibility&&a.togglePasswordVisibility(...s)),class:p(["password-toggle",{visible:s.showPassword}])},[b(S,null,{default:P(()=>[s.showPassword?l("",!0):(n(),h(_,{key:0})),s.showPassword?(n(),h(k,{key:1})):l("",!0)]),_:1})],2)])]),r("div",Z,[r("label",ss,c(a.t("forgotPassword.confirm_password_label")),1),r("div",os,[u(r("input",{"onUpdate:modelValue":o[6]||(o[6]=o=>s.confirmPassword=o),type:s.showConfirmPassword?"text":"password",class:"form-input",placeholder:a.t("forgotPassword.confirm_password_placeholder"),required:"",minlength:"6"},null,8,es),[[v,s.confirmPassword]]),r("button",{type:"button",onClick:o[7]||(o[7]=(...s)=>a.toggleConfirmPasswordVisibility&&a.toggleConfirmPasswordVisibility(...s)),class:p(["password-toggle",{visible:s.showConfirmPassword}])},[b(S,null,{default:P(()=>[s.showConfirmPassword?l("",!0):(n(),h(_,{key:0})),s.showConfirmPassword?(n(),h(k,{key:1})):l("",!0)]),_:1})],2)])]),r("button",{type:"submit",class:p(["submit-button reset-confirm-button",{loading:s.isSubmitting}]),disabled:!a.canSubmit||s.isSubmitting},[s.isSubmitting?(n(),i(f,{key:0},[o[10]||(o[10]=r("span",{class:"loading-dots"},[r("span"),r("span"),r("span")],-1)),m(" "+c(a.t("forgotPassword.resetting")),1)],64)):(n(),i(f,{key:1},[b(S,null,{default:P(()=>[b(I)]),_:1}),m(" "+c(a.t("forgotPassword.reset_password")),1)],64))],10,as)],32)),s.showSuccess?(n(),i("div",ts,[o[11]||(o[11]=r("div",{class:"success-icon"},"âœ“",-1)),r("h3",is,c(a.t("forgotPassword.reset_success_title")),1),r("p",ns,c(a.t("forgotPassword.reset_success_description")),1),b(D,{to:"/login",class:"login-redirect-button"},{default:P(()=>[m(c(a.t("forgotPassword.go_to_login")),1)]),_:1})])):l("",!0)])])}],["__scopeId","data-v-3305edab"]]),ls={class:"forgot-password-page"},ds={class:"top-controls"},cs={class:"main-card"},us={class:"back-section"},ws={class:"form-section"},ps={class:"form-content"},fs=s({__name:"ForgotPassword",setup(s){const o=V(),{t:t}=y(),l=_(""),d=s=>{l.value=s,o.back()},u=()=>{o.replace("/login")};return D(()=>{}),(s,o)=>{const t=q;return n(),i("div",ls,[o[0]||(o[0]=r("div",{class:"background-decoration"},[r("div",{class:"gradient-orb orb-1"}),r("div",{class:"gradient-orb orb-2"}),r("div",{class:"gradient-orb orb-3"})],-1)),r("div",ds,[b(e),b(a)]),r("div",cs,[r("div",us,[r("view",{onClick:u,class:"back-button"},[b(t,null,{default:P(()=>[b(E(U))]),_:1}),r("span",null,c(s.$t("forgotPassword.back_to_login")),1)])]),r("div",ws,[r("div",ps,[b(rs,{onResetSuccess:d})])])])])}}},[["__scopeId","data-v-48de6153"]]);export{fs as default};
