import{r as e,d as a,_ as t,e as l}from"./index-B4iIxVom.js";/* empty css                 */import{az as n,c as s,r as i,w as o,j as c,I as d,A as r,J as u,B as m,K as g,P as v,u as p,z as _,Q as f,a5 as y,O as h,R as M,aA as x,L as b,ah as k}from"./vendor-ClluBQmh.js";import{S as C,ah as z,D as w,B as T,H as V,l as A,E as j,P as D,aA as S,aQ as P,W as U,d as B}from"./elementPlus-5sGCOaHt.js";import{X as F}from"./xiaozhiserve-CvnNKifO.js";/* empty css                   */import"./utils-D5ZNaMwG.js";let I=class{constructor(){}async agentTemplateList(t){let l={page:t.page,page_size:t.pageSize};return t.templateType&&(l.template_type=String(t.templateType)),t.name&&(l.name=t.name),await e.common(a.xz_agent_template_list,l)}};const W={class:"template-dialog-content"},K={class:"filter-section"},L={class:"filter-label"},X={class:"filter-tags"},E={class:"templates-grid"},Q=["onClick"],R={class:"template-card-header"},$={class:"template-name"},H={class:"template-card-body"},J={class:"template-info-item"},N={class:"label"},O={class:"value"},q={class:"template-info-item"},G={class:"label"},Y={class:"value"},Z={class:"template-info-item"},ee={class:"label"},ae={class:"value"},te={class:"template-info-item"},le={class:"label"},ne={class:"value"},se={class:"dialog-footer"},ie=t({__name:"index",props:{visible:{type:Boolean,default:!1}},emits:["close","select"],setup(e,{emit:a}){const{t:t,locale:l}=n(),x=e,b=a,k=s({get:()=>x.visible,set:e=>{e||oe()}}),V=i("all"),A=i(!1),j=i([]),D=new I,S=s(()=>{const e=F.agentTemplateType(l.value);return[{label:t("agentManagement.allTypes"),value:"all"},{label:e[1],value:1},{label:e[2],value:2},{label:e[3],value:3},{label:e[4],value:4}]}),P=s(()=>j.value),U=async()=>{try{A.value=!0;const e={page:1,pageSize:100};"all"!==V.value&&(e.templateType=V.value);const a=await D.agentTemplateList(e);0===a.code&&(j.value=a.data.items||[])}catch(e){console.error("获取模板列表失败:",e)}finally{A.value=!1}},B=e=>F.agentTemplateType(l.value)[e]||"-",ie=e=>{if(!e)return"-";return{zh_male_dayi_saturn_bigtts:t("agentManagement.zhMaleDayi"),zh_female_xiaoxiao_saturn_bigtts:t("agentManagement.zhFemaleXiaoxiao"),zh_female_vv_uranus_bigtts:t("agentManagement.zhFemaleVv")}[e]||e},oe=()=>{b("close")};return o(()=>x.visible,e=>{e&&U()}),c(()=>{x.visible&&U()}),(e,a)=>{const l=C,n=w,s=T,i=z;return r(),d(s,{modelValue:k.value,"onUpdate:modelValue":a[0]||(a[0]=e=>k.value=e),title:p(t)("agentManagement.importAgentTemplate"),width:"90%",style:{maxWidth:"1000px"},center:"",onClose:oe},{footer:u(()=>[m("span",se,[M(n,{onClick:oe},{default:u(()=>[h(v(p(t)("common.cancel")),1)]),_:1})])]),default:u(()=>[m("div",W,[m("div",K,[m("div",L,v(p(t)("agentManagement.templateType"))+":",1),m("div",X,[(r(!0),_(f,null,y(S.value,e=>(r(),d(l,{key:e.value,type:V.value===e.value?"primary":"info",effect:V.value===e.value?"dark":"plain",class:"filter-tag",onClick:a=>(e=>{V.value=e,U()})(e.value)},{default:u(()=>[h(v(e.label),1)]),_:2},1032,["type","effect","onClick"]))),128))])]),g((r(),_("div",E,[(r(!0),_(f,null,y(P.value,e=>{return r(),_("div",{key:e.id,class:"template-card",onClick:a=>(e=>{b("select",e),oe()})(e)},[m("div",R,[m("h3",$,v(e.name),1),M(l,{size:"small",type:(n=e.template_type,{1:"success",2:"danger",3:"warning",4:"info"}[n]||"info")},{default:u(()=>[h(v(B(e.template_type)),1)]),_:2},1032,["type"])]),m("div",H,[m("div",J,[m("span",N,v(p(t)("agentManagement.character"))+":",1),m("span",O,v(e.ext_data?.character||"-"),1)]),m("div",q,[m("span",G,v(p(t)("agentManagement.llmModel"))+":",1),m("span",Y,v(e.ext_data?.llm_model||"-"),1)]),m("div",Z,[m("span",ee,v(p(t)("agentManagement.language"))+":",1),m("span",ae,v((a=e.ext_data?.language,{zh:t("agentManagement.zh"),en:t("agentManagement.en")}[a]||"-")),1)]),m("div",te,[m("span",le,v(p(t)("agentManagement.ttsVoice"))+":",1),m("span",ne,v(ie(e.ext_data?.tts_voice)),1)])])],8,Q);var a,n}),128))])),[[i,A.value]])])]),_:1},8,["modelValue","title"])}}},[["__scopeId","data-v-75d38562"]]),oe={class:"agent-management"},ce={class:"page-header"},de={class:"header-content"},re={class:"header-actions"},ue={class:"search-container"},me={class:"agents-section"},ge={class:"agents-grid"},ve={class:"agent-card-header"},pe={class:"agent-name"},_e={class:"agent-actions"},fe={class:"agent-card-body"},ye={class:"agent-info-item"},he={class:"label"},Me={class:"value"},xe={class:"agent-info-item"},be={class:"label"},ke={class:"value"},Ce={key:0,class:"agent-info-item"},ze={class:"label"},we=["onClick"],Te={key:1,class:"loading-container"},Ve={class:"loading-text"},Ae={key:2,class:"empty-container"},je={class:"empty-content"},De={class:"empty-text"},Se={class:"bind-dialog-content"},Pe={class:"dialog-footer"},Ue={class:"delete-dialog-content"},Be={class:"delete-warning"},Fe={class:"dialog-footer"},Ie={key:0,style:{height:"60px"}},We=t({__name:"AgentManagement",setup(e){const{t:a}=n(),t=x(),s=new F,o=i(!1),d=i(!1),g=i(!1),C=i(""),z=i(""),I=i(""),W=i(""),K=i([]),L=i(!1),X=i(1),E=i(10),Q=i(!0),R=async()=>{if(Q.value)try{L.value=!0;const e={user_id:"",agent_name:W.value,sync_status:"",page:X.value,page_size:E.value},a=await s.listAgent(e);if(0===a.code&&a.data){const e=a.data.items||[];1===X.value?K.value=e:K.value=[...K.value,...e];const t=a.data.total||0;Q.value=K.value.length<t,X.value++}else B.error(a.msg||"获取智能体列表失败")}catch(e){console.error("获取智能体列表出错:",e),B.error("获取智能体列表失败")}finally{L.value=!1}},$=()=>{R()},H=e=>{C.value=e.replace(/[^0-9]/g,"").slice(0,6)},J=()=>{o.value=!1,C.value="",z.value="",I.value=""},N=async()=>{if(6===C.value.length){try{L.value=!0;const e={agent_id:I.value,verification_code:C.value},a=await s.addDeviceAgent(e);console.log("addDeviceAgent响应结果:",a),0===a.code?(B.success("设备绑定成功！"),O()):B.error(a.msg||"设备绑定失败")}catch(e){console.error("设备绑定出错:",e),B.error("设备绑定失败")}finally{L.value=!1}J()}},O=()=>{K.value=[],X.value=1,Q.value=!0,L.value=!1,R()},q=()=>{d.value=!1,z.value="",I.value=""},G=async()=>{try{L.value=!0;const e={id:I.value};0===(await s.deleteAgent(e)).code?B.success("success"):B.error("err"),O()}catch(e){console.error("删除智能体出错:",e),B.error("智能体删除失败")}finally{L.value=!1}q()},Y=()=>{t.push("/add-agent")},Z=()=>{g.value=!0},ee=async e=>{try{L.value=!0;const t={agent_name:e.ext_data?.agent_name||e.name,assistant_name:e.ext_data?.assistant_name,llm_model:e.ext_data?.llm_model,tts_voice:e.ext_data?.tts_voice,tts_speech_speed:e.ext_data?.tts_speech_speed,tts_pitch:e.ext_data?.tts_pitch,asr_speed:e.ext_data?.asr_speed,language:e.ext_data?.language,character:e.ext_data?.character,memory:e.ext_data?.memory,memory_type:e.ext_data?.memory_type,mcp_endpoints:e.ext_data?.mcp_endpoints||[],knowledge_base_ids:e.ext_data?.knowledge_base_ids||[]},l=await s.createAgent(t);0===l.code?(B.success(a("agentManagement.importTemplateSuccess")),O()):B.error(l.msg||a("agentManagement.importTemplateFailed"))}catch(t){console.error("导入智能体模板出错:",t),B.error(a("agentManagement.importTemplateFailed"))}finally{L.value=!1}},ae=e=>{O()};return c(()=>{O()}),(e,n)=>{const s=V,i=j,c=w,x=T,B=U;return r(),_(f,null,[M(B,{height:"100%",onEndReached:$},{default:u(()=>[m("div",oe,[m("div",ce,[m("div",de,[n[5]||(n[5]=m("h1",{class:"page-title"},null,-1)),m("div",re,[m("div",ue,[M(s,{modelValue:W.value,"onUpdate:modelValue":n[0]||(n[0]=e=>W.value=e),placeholder:p(a)("agentManagement.searchPlaceholder"),"prefix-icon":p(A),clearable:"",onKeyup:k(ae,["enter"]),size:"default"},null,8,["modelValue","placeholder","prefix-icon"])]),M(c,{type:"default",onClick:Z},{default:u(()=>[M(i,null,{default:u(()=>[M(p(D))]),_:1}),h(" "+v(p(a)("agentManagement.importAgentTemplate")),1)]),_:1}),M(c,{type:"primary",onClick:Y},{default:u(()=>[M(i,null,{default:u(()=>[M(p(S))]),_:1}),h(" "+v(p(a)("agentManagement.addAgent")),1)]),_:1})])])]),m("div",me,[m("div",ge,[K.value.length>0?(r(!0),_(f,{key:0},y(K.value,e=>(r(),_("div",{class:"agent-card",key:e.id},[m("div",ve,[m("h3",pe,v(e.agent_name||p(a)("agentManagement.unnamedAgent")),1),m("div",_e,[M(c,{size:"small",onClick:a=>{return l=e.id,console.log("编辑智能体:",l),void t.push(`/add-agent?id=${l}`);var l}},{default:u(()=>[h(v(p(a)("agentManagement.editAgent")),1)]),_:1},8,["onClick"]),M(c,{type:"primary",size:"small",onClick:a=>{return t=e.id,l=e.agent_name,z.value=l,I.value=t,o.value=!0,void(C.value="");var t,l}},{default:u(()=>[h(v(e.sync_status?p(a)("agentManagement.rebindDevice"):p(a)("agentManagement.bindDevice")),1)]),_:2},1032,["onClick"]),M(c,{type:"danger",size:"small",onClick:a=>{return t=e.id,l=e.agent_name,z.value=l,I.value=t,void(d.value=!0);var t,l}},{default:u(()=>[h(v(p(a)("agentManagement.deleteAgent")),1)]),_:1},8,["onClick"])])]),m("div",fe,[m("div",ye,[m("span",he,v(p(a)("agentManagement.character"))+"：",1),m("span",Me,v(e.character||p(a)("agentManagement.notSet")),1)]),m("div",xe,[m("span",be,v(p(a)("agentManagement.llmModel"))+"：",1),m("span",ke,v(e.llm_model||p(a)("agentManagement.notSet")),1)]),e.device_count>0?(r(),_("div",Ce,[m("span",ze,v(p(a)("agentManagement.deviceCount"))+"：",1),m("span",{class:"value device-count-link",onClick:a=>{return l=e.id,console.log("查看设备列表:",l),void t.push(`/device-list/${l}`);var l}},v(e.device_count)+" "+v(p(a)("agentManagement.devices")),9,we)])):b("",!0)])]))),128)):b("",!0),L.value&&0===K.value.length?(r(),_("div",Te,[m("div",Ve,v(p(a)("agentManagement.loading")),1)])):b("",!0),L.value||0!==K.value.length?b("",!0):(r(),_("div",Ae,[m("div",je,[M(i,{size:"64"},{default:u(()=>[M(p(P))]),_:1}),m("p",De,v(p(a)("agentManagement.noAgents")),1)])]))]),M(x,{modelValue:o.value,"onUpdate:modelValue":n[2]||(n[2]=e=>o.value=e),title:p(a)("agentManagement.bindDeviceTitle"),width:"400px",center:""},{footer:u(()=>[m("span",Pe,[M(c,{onClick:J},{default:u(()=>[h(v(p(a)("common.cancel")),1)]),_:1}),M(c,{type:"primary",onClick:N,disabled:6!==C.value.length},{default:u(()=>[h(v(p(a)("agentManagement.confirmBind")),1)]),_:1},8,["disabled"])])]),default:u(()=>[m("div",Se,[m("p",null,v(p(a)("agentManagement.enterVerificationCode")),1),M(s,{modelValue:C.value,"onUpdate:modelValue":n[1]||(n[1]=e=>C.value=e),key:"verification_code",placeholder:p(a)("agentManagement.verificationCodePlaceholder"),maxlength:"6","show-word-limit":"",onInput:H,onKeyup:k(N,["enter"])},null,8,["modelValue","placeholder"])])]),_:1},8,["modelValue","title"]),M(x,{modelValue:d.value,"onUpdate:modelValue":n[3]||(n[3]=e=>d.value=e),title:p(a)("agentManagement.deleteConfirmTitle"),width:"400px",center:""},{footer:u(()=>[m("span",Fe,[M(c,{onClick:q},{default:u(()=>[h(v(p(a)("common.cancel")),1)]),_:1}),M(c,{type:"danger",onClick:G},{default:u(()=>[h(v(p(a)("common.delete")),1)]),_:1})])]),default:u(()=>[m("div",Ue,[m("p",null,v(p(a)("agentManagement.deleteConfirmContent")),1),m("p",Be,v(p(a)("agentManagement.deleteWarning")),1)])]),_:1},8,["modelValue","title"])])]),p(l).isPortraitDevice()?(r(),_("div",Ie)):b("",!0)]),_:1}),M(ie,{visible:g.value,onClose:n[4]||(n[4]=e=>g.value=!1),onSelect:ee},null,8,["visible"])],64)}}},[["__scopeId","data-v-a9f88490"]]);export{We as default};
