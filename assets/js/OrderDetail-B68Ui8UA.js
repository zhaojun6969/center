import{r as e,c as s,d as a,_ as t}from"./index-7lN_iYAB.js";/* empty css                 *//* empty css                    *//* empty css                         */import{z as i,A as l,B as r,R as n,P as o,J as c,Q as d,a5 as u,I as p,u as m,E as v,O as E,L as g,az as _,aB as I,aA as y,r as R,c as f,j as D,f as N}from"./vendor-zwaLhAD5.js";import{a3 as O,a0 as T,E as C,u as P,a4 as S,Z as h,a5 as A,$ as F,Y as L,p as k,a6 as M,a7 as b,a8 as w,_ as Y,O as V,F as $,X as j,a9 as x,aa as U}from"./elementPlus-CAPqDV7g.js";import{g as B,O as H}from"./OrderManagement-D1doi4Hu.js";/* empty css                                                                          */import{d as X}from"./date-CgH6eVIF.js";import"./utils-D5HVl94d.js";var G={};class z{RULE=(()=>"undefined"!=typeof window?"client":"undefined"!=typeof process?G.VITE_PROJECTTYPE:void 0)();ship(a){let t={orderId:a.orderId,orderNo:a.orderNo,trackingNo:a.trackingNo,logisticsCompanyCode:a.logisticsCompanyCode,logisticsCompany:a.logisticsCompany,customerName:a.customerName,remark:a.remark};return e.common(s.sh_ship,t)}getLogisticsByOrderId(t){const i="client"===this.RULE?a.wl_get_by_order:s.wl_get_by_order,l={url:i.url.replace("ORDER_ID",t.orderId),method:i.method,isLoading:i.isLoading};return e.common(l,{})}refreshLogisticsByOrderId(t){t.orderId;const i="client"===this.RULE?a.wl_refresh:s.wl_refresh,l={url:i.url.replace("ORDER_ID",t.orderId),method:i.method,isLoading:i.isLoading};return e.common(l,{})}}const q={class:"logistics-timeline"},J={class:"timeline-header"},K={class:"tracking-number"},Q={class:"event-header"},Z={class:"event-title"},W={class:"event-content"},ee={class:"event-description"},se={key:0,class:"event-operator"},ae={class:"logistics-info"},te={class:"info-card"},ie={class:"card-header"},le={class:"card-content"},re={class:"info-row"},ne={class:"label"},oe={class:"value"},ce={class:"info-row"},de={class:"label"},ue={class:"value"},pe={class:"info-row"},me={class:"label"},ve={class:"value"},Ee={class:"info-card"},ge={class:"card-header"},_e={class:"card-content"},Ie={class:"location-info"},ye={class:"current-address"},Re={class:"status-update"},fe=t({__name:"LogisticsTimeline",props:{orderId:{type:String,required:!0},trackingNumber:{type:String,default:""},timelineEvents:{type:Array,default:()=>[]},logisticsInfo:{type:Object,default:()=>({})}},emits:["refresh"],setup(e,{emit:s}){const a={ORDER_CREATED:"order_created",PAYMENT_CONFIRMED:"payment_confirmed",PROCESSING:"processing",SHIPPED:"shipped",IN_TRANSIT:"in_transit",OUT_FOR_DELIVERY:"out_for_delivery",EXCEPTION:"exception"},t=e=>({[a.ORDER_CREATED]:Y,[a.PAYMENT_CONFIRMED]:L,[a.PROCESSING]:w,[a.SHIPPED]:b,[a.IN_TRANSIT]:h,[a.OUT_FOR_DELIVERY]:M,[a.DELIVERED]:k,[a.EXCEPTION]:L}[e]||L),_=e=>({[a.DELIVERED]:"success",[a.EXCEPTION]:"danger",[a.SHIPPED]:"primary",[a.PROCESSING]:"warning"}[e]||"info"),I=e=>({[a.ORDER_CREATED]:"订单已创建",[a.PAYMENT_CONFIRMED]:"支付确认",[a.PROCESSING]:"订单处理中",[a.SHIPPED]:"已发货",[a.IN_TRANSIT]:"运输中",[a.OUT_FOR_DELIVERY]:"派送中",[a.DELIVERED]:"已送达",[a.EXCEPTION]:"异常状态"}[e]||"未知状态"),y=e=>({[a.ORDER_CREATED]:"已完成",[a.PAYMENT_CONFIRMED]:"已完成",[a.PROCESSING]:"进行中",[a.SHIPPED]:"已完成",[a.IN_TRANSIT]:"进行中",[a.OUT_FOR_DELIVERY]:"进行中",[a.DELIVERED]:"已完成",[a.EXCEPTION]:"需处理"}[e]||"未知"),R=e=>({[a.ORDER_CREATED]:"completed",[a.PAYMENT_CONFIRMED]:"completed",[a.PROCESSING]:"processing",[a.SHIPPED]:"completed",[a.IN_TRANSIT]:"processing",[a.OUT_FOR_DELIVERY]:"processing",[a.DELIVERED]:"completed",[a.EXCEPTION]:"pending"}[e]||"pending"),f=e=>({[a.ORDER_CREATED]:"info",[a.PAYMENT_CONFIRMED]:"success",[a.PROCESSING]:"warning",[a.SHIPPED]:"primary",[a.IN_TRANSIT]:"warning",[a.OUT_FOR_DELIVERY]:"warning",[a.DELIVERED]:"success",[a.EXCEPTION]:"danger"}[e]||"info");return(s,D)=>{const N=T,L=C,k=O,M=S;return l(),i("div",q,[r("div",J,[r("h3",null,o(s.$t("logistics.title")),1),r("span",K,o(s.$t("logistics.trackingNumber"))+": "+o(e.trackingNumber),1)]),n(M,null,{default:c(()=>[(l(!0),i(d,null,u(e.timelineEvents,(e,s)=>{return l(),p(k,{key:s,timestamp:m(X).formatDate(e.timestamp),color:(d=e.type,document.documentElement.classList.contains("dark")?{[a.ORDER_CREATED]:"#9CA3AF",[a.PAYMENT_CONFIRMED]:"#60A5FA",[a.PROCESSING]:"#FBBF24",[a.SHIPPED]:"#A78BFA",[a.IN_TRANSIT]:"#34D399",[a.OUT_FOR_DELIVERY]:"#FB923C",[a.DELIVERED]:"#4ADE80",[a.EXCEPTION]:"#F87171"}[d]||"#9CA3AF":{[a.ORDER_CREATED]:"#909399",[a.PAYMENT_CONFIRMED]:"#409EFF",[a.PROCESSING]:"#E6A23C",[a.SHIPPED]:"#8B5CF6",[a.IN_TRANSIT]:"#00BFA6",[a.OUT_FOR_DELIVERY]:"#FF9800",[a.DELIVERED]:"#4CAF50",[a.EXCEPTION]:"#F44336"}[d]||"#909399"),icon:t(e.type),type:_(e.type),size:0===s?"large":"normal",placement:"top"},{default:c(()=>[r("div",{class:v(["timeline-event",R(e.type)])},[r("div",Q,[r("span",Z,o(I(e.type)),1),n(N,{type:f(e.type),size:"small"},{default:c(()=>[E(o(y(e.type)),1)]),_:2},1032,["type"])]),r("div",W,[r("p",ee,o(e.description),1),e.operator?(l(),i("div",se,[n(L,null,{default:c(()=>[n(m(P))]),_:1}),r("span",null,o(e.operator),1)])):g("",!0)])],2)]),_:2},1032,["timestamp","color","icon","type","size"]);var d}),128))]),_:1}),r("div",ae,[r("div",te,[r("div",ie,[n(L,null,{default:c(()=>[n(m(h))]),_:1}),r("span",null,o(s.$t("logistics.carrierInfo")),1)]),r("div",le,[r("div",re,[r("span",ne,o(s.$t("logistics.carrier"))+":",1),r("span",oe,o(e.logisticsInfo.carrier||"顺丰速运"),1)]),r("div",ce,[r("span",de,o(s.$t("logistics.service"))+":",1),r("span",ue,o(e.logisticsInfo.service||"标准快递"),1)]),r("div",pe,[r("span",me,o(s.$t("logistics.estimatedDelivery"))+":",1),r("span",ve,o(m(X).formatDate(e.logisticsInfo.estimatedDelivery)),1)])])]),r("div",Ee,[r("div",ge,[n(L,null,{default:c(()=>[n(m(A))]),_:1}),r("span",null,o(s.$t("logistics.currentLocation")),1)]),r("div",_e,[r("div",Ie,[r("p",ye,o(e.logisticsInfo.currentLocation||"北京市朝阳区分拣中心"),1),r("div",Re,[n(L,null,{default:c(()=>[n(m(F))]),_:1}),r("span",null,o(s.$t("logistics.lastUpdate"))+": "+o(m(X).formatDate(e.logisticsInfo.lastUpdate)),1)])])])])])])}}},[["__scopeId","data-v-ac75861b"]]),De={key:0,class:"order-detail"},Ne={class:"detail-header"},Oe={class:"header-left"},Te={class:"detail-grid"},Ce={class:"detail-card"},Pe={class:"card-title"},Se={class:"products-list"},he={class:"product-item"},Ae=["src","alt"],Fe={class:"product-info"},Le={class:"name"},ke={style:{"margin-top":"10px"},class:"qty"},Me={class:"price"},be={class:"detail-card"},we={class:"card-title"},Ye={class:"payment-info"},Ve={key:0},$e={key:0,class:"expired-notice",style:{"margin-top":"10px"}},je={class:"detail-card"},xe={class:"card-title"},Ue={style:{"margin-top":"16px"}},Be={style:{"margin-top":"16px"}},He={style:{"margin-top":"16px"}},Xe={key:0,class:"timeline-section"},Ge={key:0},ze={class:"logistics-timeline"},qe={class:"timeline-header"},Je={class:"tracking-number"},Ke={class:"logistics-content-wrapper"},Qe={class:"logistics-info"},Ze={class:"info-card"},We={class:"card-header"},es={class:"card-content"},ss={class:"info-row"},as={class:"label"},ts={class:"value"},is={class:"info-row"},ls={class:"label"},rs={class:"info-row"},ns={class:"label"},os={class:"value"},cs={class:"logistics-timeline-container"},ds={class:"timeline-title"},us={class:"logistics-item"},ps={class:"logistics-content"},ms={key:0,class:"logistics-location"},vs={key:1,class:"loading-container"},Es={key:2,class:"no-logistics-data"},gs={key:1,class:"timeline-section"},_s=t({__name:"OrderDetail",setup(e){const s=new H,{t:a}=_(),t=I(),v=y(),P=R(null),A=R({}),F=R(null),L=R(!1),k=e=>{if(!e)return"-";const s=new Date(e);return s.toLocaleDateString()+" "+s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},M=R(""),b=f(()=>B(P.value)),w=new z,Y=e=>{L.value=!0,w.getLogisticsByOrderId({orderId:e}).then(e=>{L.value=!1,0===e.code&&e.data?F.value=e.data:(console.error("获取物流信息失败:",e),F.value=null)}).catch(e=>{L.value=!1,console.error("获取物流信息失败:",e),F.value=null})};D(()=>P.value,e=>{!e||"yfh"!==b.value.type&&"yjs"!==b.value.type||Y(e.id)},{deep:!0});const X=()=>{v.push({name:"order-management"})};return N(()=>{const e=t.params.orderId;M.value=e,(()=>{let e={id:M.value};s.getOrderDetail(e).then(e=>{P.value=e.data,A.value=P.value?.order_info?.shipping,!P.value||"yfh"!==b.value.type&&"yjs"!==b.value.type||Y(P.value.id)})})()}),(e,s)=>{const t=C,v=$,_=T,I=O,y=S,R=x,f=U;return P.value?(l(),i("div",De,[r("div",Ne,[r("div",Oe,[n(v,{text:"",onClick:X,class:"back-btn"},{default:c(()=>[n(t,null,{default:c(()=>[n(m(V))]),_:1}),E(" "+o(m(a)("orderManagement.title"))+"#"+o(P.value.order_no),1)]),_:1})]),n(_,{type:b.value.status,size:"large"},{default:c(()=>[E(o(m(a)(b.value.label)),1)]),_:1},8,["type"])]),r("div",Te,[r("div",Ce,[r("h3",Pe,o(m(a)("orderManagement.order.products")),1),r("div",Se,[r("div",he,[r("img",{src:P.value?.order_info?.modelData?.imageUrl,alt:P.value.order_info.ipName,class:"product-image"},null,8,Ae),r("div",Fe,[r("span",Le,o(P.value.order_info.ipName),1),r("span",ke,"x"+o(P.value.order_info.quantity),1)]),r("div",Me,o(P.value.currency)+" "+o(Number(P.value.actual_amount).toFixed(2)),1)])])]),r("div",be,[r("h3",we,o(m(a)("orderManagement.order.payment")),1),r("div",Ye,[r("p",null,[r("strong",null,o(m(a)("orderManagement.order.paymentMethod"))+":",1),E(" "+o(P.value.currency),1)]),r("p",null,[r("strong",null,o(m(a)("orderManagement.order.paymentStatus"))+":",1),E(" "+o(m(a)(b.value.label)),1)]),P.value.payment_time?(l(),i("p",Ve,[r("strong",null,o(m(a)("orderManagement.order.paidAt"))+":",1),E(" "+o(k(P.value.payment_time)),1)])):g("",!0)]),"zfgq"==b.value.type?(l(),i("div",$e,[n(t,null,{default:c(()=>[n(m(j))]),_:1}),r("span",null,o(m(a)("orderManagement.expiredNotice")),1)])):g("",!0)]),r("div",je,[r("h3",xe,o(m(a)("orderManagement.order.shipping")),1),r("p",Ue,[r("strong",null,o(m(a)("orderManagement.order.recipient"))+"：",1),E(" "+o(A.value?.firstName+A.value?.lastName||"-"),1)]),r("p",Be,[r("strong",null,o(m(a)("orderManagement.order.phone"))+"：",1),E(" "+o(A.value?.phone||"-"),1)]),r("p",He,[r("strong",null,o(m(a)("orderManagement.order.address"))+"：",1),E(" "+o(A.value?.countryLabel+A.value?.address1+A.value?.address2+A.value?.city||"-"),1)])])]),"yfh"===b.value.type||"yjs"===b.value.type?(l(),i("div",Xe,[F.value?(l(),i("div",Ge,[r("div",ze,[r("div",qe,[r("h3",null,o(e.$t("logistics.title")),1),r("span",Je,o(e.$t("logistics.trackingNumber"))+": "+o(F.value.trackingNo),1)]),r("div",Ke,[r("div",Qe,[r("div",Ze,[r("div",We,[n(t,null,{default:c(()=>[n(m(h))]),_:1}),r("span",null,o(e.$t("logistics.carrierInfo")),1)]),r("div",es,[r("div",ss,[r("span",as,o(e.$t("logistics.carrier"))+":",1),r("span",ts,o(F.value.logisticsCompany),1)]),r("div",is,[r("span",ls,o(e.$t("logistics.status"))+":",1),n(_,{type:4===F.value.logisticsStatus?"success":"info"},{default:c(()=>[E(o(F.value.logisticsStatusText),1)]),_:1},8,["type"])]),r("div",rs,[r("span",ns,o(e.$t("logistics.trackingNumber"))+":",1),r("span",os,o(F.value.trackingNo),1)])])])]),r("div",cs,[r("div",ds,o(e.$t("logistics.timeline")),1),n(y,null,{default:c(()=>[(l(!0),i(d,null,u(F.value.traces.slice().reverse(),(e,s)=>(l(),p(I,{key:s,timestamp:e.time,type:0===s?"success":"primary"},{default:c(()=>[r("div",us,[r("div",ps,o(e.description),1),e.location?(l(),i("div",ms,o(e.location),1)):g("",!0)])]),_:2},1032,["timestamp","type"]))),128))]),_:1})])])])])):L.value?(l(),i("div",vs,[n(R,{rows:10,animated:""})])):(l(),i("div",Es,[n(f,{description:"暂无物流信息"})]))])):g("",!0),!P.value.timelineEvents||"paid"!==P.value.status&&"shipped"!==P.value.status&&"completed"!==P.value.status?g("",!0):(l(),i("div",gs,[n(fe,{"order-id":P.value.id,"tracking-number":P.value.tracking?.number||"","timeline-events":P.value.timelineEvents,"logistics-info":P.value.logisticsInfo||{}},null,8,["order-id","tracking-number","timeline-events","logistics-info"])]))])):g("",!0)}}},[["__scopeId","data-v-23dc680c"]]);export{_s as default};
