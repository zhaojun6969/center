import{az as e,r as a,c as s,j as o,aB as i,U as t,z as r,B as l,L as c,P as n,u as d,Q as u,a5 as g,aA as p,A as m}from"./vendor-ClluBQmh.js";import{S as v}from"./index-7vXv9XNO.js";import{_ as h,e as w}from"./index-B4iIxVom.js";import"./elementPlus-5sGCOaHt.js";import"./utils-D5ZNaMwG.js";const k={class:"mobile-category-container"},y={class:"mobile-header"},b={class:"mobile-title"},f={class:"category-banner"},x={class:"category-banner-desc"},P={key:0,class:"empty-state"},C={key:1,class:"products-grid"},j=["onClick"],L={class:"product-image"},M=["src","alt"],D={key:0,class:"product-badge"},F={key:1,class:"discount-badge"},I={class:"product-info"},B={class:"product-name"},$={class:"product-desc"},_={class:"product-footer"},z={class:"price-section"},N={class:"current-price"},S={key:0,class:"original-price"},A={key:2,class:"load-more"},E=["disabled"],q={key:0},G={key:1},H=h({__name:"mobile",setup(h){const H=p(),R=i(),{t:Q}=e(),U=new v,Y=a(1),J=a(12),K=a(0),O=a(!1),T=a(!0),V=a({id:null,name:"",description:"",image:""}),W=a([]),X=async(e,a=1)=>{if(!O.value){O.value=!0;try{const s=await U.getGoodsList({categoryId:e,pageSize:J.value,pageNum:a});if(console.log("Goods List Response for category",e,":",s),s&&s.success&&s.data&&s.data.rows){if(1===a)W.value=s.data.rows.map(e=>({id:e.id,name:e.goodsName,description:e.shortDesc||"",image:e.mainImage||e.images?.[0]||"",price:e.price?.toFixed(2)||"0",originalPrice:e.originalPrice?.toFixed(2)||"",discount:e.originalPrice?`-${Math.round(100*(1-e.price/e.originalPrice))}%`:"",badge:e.tags?.[0]||"",inStock:e.stock>0}));else{const e=s.data.rows.map(e=>({id:e.id,name:e.goodsName,description:e.shortDesc||"",image:e.mainImage||e.images?.[0]||"",price:e.price?.toFixed(2)||"0",originalPrice:e.originalPrice?.toFixed(2)||"",discount:e.originalPrice?`-${Math.round(100*(1-e.price/e.originalPrice))}%`:"",badge:e.tags?.[0]||"",inStock:e.stock>0}));W.value=[...W.value,...e]}K.value=s.data.total||0,T.value=W.value.length<K.value}}catch(s){console.error("Failed to fetch goods list:",s)}finally{O.value=!1}}},Z=()=>{T.value&&!O.value&&(Y.value++,X(V.value.id,Y.value))},ee=()=>{window.scrollY+window.innerHeight>=document.documentElement.scrollHeight-500&&Z()},ae=s(()=>W.value);s(()=>Math.ceil(K.value/J.value));const se=()=>{H.push("/shop")};return o(()=>{const e=R.params.category;e&&(console.log("Category ID:",e),(async e=>{try{const a=await U.getCategoryList();if(console.log("Category List Response:",a),a&&a.success&&a.data){const s=a.data.find(a=>a.id===parseInt(e));s&&(V.value={id:s.id,name:s.categoryName,description:s.description||"",image:s.image||""})}}catch(a){console.error("Failed to fetch category detail:",a)}})(e),X(e,1),window.addEventListener("scroll",ee))}),t(()=>{window.removeEventListener("scroll",ee)}),(e,a)=>(m(),r("div",k,[l("div",y,[l("button",{class:"back-btn",onClick:se},[...a[0]||(a[0]=[l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2.5",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})],-1)])]),l("h1",b,n(V.value.name),1),a[1]||(a[1]=l("div",{class:"header-spacer"},null,-1))]),l("div",f,[l("p",x,n(V.value.description),1)]),0===ae.value.length?(m(),r("div",P,[a[2]||(a[2]=l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[l("path",{"stroke-linecap":"square","stroke-linejoin":"miter",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})],-1)),l("p",null,n(d(Q)("shop.category.noProducts")),1)])):(m(),r("div",C,[(m(!0),r(u,null,g(ae.value,e=>(m(),r("div",{key:e.id,class:"product-card",onClick:a=>{return s=e.id,void H.push(`/shop/detail/${s}`);var s}},[l("div",L,[l("img",{src:e.image,alt:e.name},null,8,M),e.badge?(m(),r("div",D,n(e.badge),1)):c("",!0),e.discount?(m(),r("div",F,n(e.discount),1)):c("",!0)]),l("div",I,[l("h3",B,n(e.name),1),l("p",$,n(e.description),1),l("div",_,[l("div",z,[l("span",N,n(d(w).isDomesticDomain()?"¥":"$")+n(e.price),1),e.originalPrice?(m(),r("span",S,n(d(w).isDomesticDomain()?"¥":"$")+n(e.originalPrice),1)):c("",!0)]),a[3]||(a[3]=l("button",{class:"add-cart-btn"},[l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor"},[l("path",{"stroke-linecap":"square","stroke-linejoin":"miter",d:"M12 4.5v15m7.5-7.5h-15"})])],-1))])])],8,j))),128))])),T.value?(m(),r("div",A,[l("button",{class:"load-more-btn",onClick:Z,disabled:O.value},[O.value?(m(),r("span",G,n(d(Q)("shop.category.loading")),1)):(m(),r("span",q,n(d(Q)("shop.category.loadMore")),1))],8,E)])):c("",!0)]))}},[["__scopeId","data-v-1a232bac"]]);export{H as default};
