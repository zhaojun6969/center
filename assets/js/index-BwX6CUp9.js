import{_ as e,W as s,u as t,e as a,F as l,j as i}from"./index-7lN_iYAB.js";/* empty css                 *//* empty css                    *//* empty css                         *//* empty css                 */import{aA as r,az as n,r as u,f as o,z as c,A as d,B as v,L as p,R as m,E as C,P as h,ah as y,J as $,O as f,u as b,Q as g,a5 as k,n as w}from"./vendor-zwaLhAD5.js";import{U as R}from"./index-B5bLabF4.js";import{M as x}from"./index-CZQe1qZR.js";import{I as A,F as M,a9 as D,aa as L,C as _,d as j}from"./elementPlus-CAPqDV7g.js";import"./utils-D5HVl94d.js";const U={class:"user-center-container"},P={class:"user-info-section"},z={class:"user-avatar-section"},I={class:"avatar-wrapper"},O=["src"],V={class:"user-details-section"},F={class:"user-name-row"},S={class:"editable-name-container"},T={key:0,class:"name-edit-form"},B={class:"user-email"},q={class:"points-section"},J={class:"points-content-container"},K={class:"points-list"},Q={class:"total-points"},W={class:"total-label"},E={class:"points-value"},G={class:"points-items"},H={class:"points-item-left"},N={class:"points-number"},X={class:"points-item-right"},Y={class:"expiry-label"},Z={class:"expiry-date"},ee={class:"points-consumption-rules"},se={class:"rules-table-container"},te={class:"points-rules-table"},ae={class:"additional-rules"},le={key:0,class:"voucher-section"},ie={class:"voucher-list-container"},re={key:0,class:"loading-container"},ne={key:1,class:"empty-vouchers"},ue={key:2,class:"voucher-grid"},oe={class:"voucher-header"},ce={class:"voucher-amount"},de={class:"currency"},ve={class:"amount"},pe={class:"voucher-status"},me={class:"voucher-body"},Ce={class:"voucher-info"},he={class:"voucher-code"},ye={key:0,class:"voucher-min-order"},$e={class:"voucher-expiry"},fe={class:"expiry-label"},be={class:"expiry-date"},ge={key:1,class:"invitation-section"},ke={class:"invitation-info"},we={class:"info-item"},Re={class:"invite-codes-section"},xe={class:"section-header"},Ae={class:"invite-cards-container"},Me={class:"card-header"},De={class:"card-title"},Le={key:0,class:"used-badge"},_e={class:"invite-code-value"},je={class:"card-footer"},Ue={class:"invitation-rules"},Pe={class:"rules-container"},ze={class:"role-rules free-rules"},Ie={class:"role-rules-with-upgrade creator-rules"},Oe={class:"role-rules-content"},Ve={key:2,style:{height:"60px"}},Fe={class:"voucher-detail"},Se={class:"detail-section"},Te={class:"detail-label"},Be={class:"detail-value"},qe={class:"detail-section"},Je={class:"detail-label"},Ke={class:"detail-value amount"},Qe={class:"currency"},We={class:"amount"},Ee={class:"detail-section"},Ge={class:"detail-label"},He={class:"detail-value status"},Ne={class:"detail-section"},Xe={class:"detail-label"},Ye={class:"detail-value"},Ze={class:"detail-section"},es={class:"detail-label"},ss={class:"detail-value"},ts={class:"detail-section"},as={class:"detail-label"},ls={class:"detail-value"},is={class:"detail-section"},rs={class:"detail-label"},ns={class:"detail-value"},us={class:"dialog-footer"},os=e({__name:"index",setup(e){new s;const os=r(),cs=new x,{t:ds}=n(),vs=t(),ps=new R,ms=new l,Cs=u({role:"2"==vs.user?.userRole?"creator":"free",avatar:vs.user?.avatarUrl,nickname:vs.user?.nickname,email:vs.user?.email||"",currentPoints:0,pointsList:[],inviteCodes:[],inviteCount:0,voucherCount:{availableCount:0,usedCount:0,expiredCount:0,totalCount:0},voucherList:[]}),hs=u(null),ys=u(!1),$s=u(!1),fs=u(0);o(()=>{(async()=>{try{$s.value=!0;const e=await ps.getCodes();if(e.success){const s=e.data.map(e=>({code:e.inviteCode,used:1===e.isUsed,createdAt:e.createdAt,codeType:e.codeType}));Cs.value.inviteCodes=s,Cs.value.inviteCount=s.length}else j.error(e.message||"èŽ·å–é‚€è¯·ç å¤±è´¥")}catch(e){console.error("èŽ·å–é‚€è¯·ç å¤±è´¥:",e),j.error("èŽ·å–é‚€è¯·ç å¤±è´¥")}finally{$s.value=!1}})(),(async()=>{const{data:e}=await cs.getModelLimits();fs.value=e.total_score})(),(async()=>{try{$s.value=!0;const e=await ps.getVoucherList();e.success&&(Cs.value.voucherList=e.data)}catch(e){console.error("èŽ·å–ä¼˜æƒ åˆ¸åˆ—è¡¨å¤±è´¥:",e),j.error("èŽ·å–ä¼˜æƒ åˆ¸åˆ—è¡¨å¤±è´¥")}finally{$s.value=!1}})()});const bs=u(null),gs=()=>{bs.value?.click()},ks=async e=>{const s=e.target.files?.[0];if(s)if(s.type.startsWith("image/"))if(s.size>5242880)j.error("å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡5MB");else{try{const e=await ms.uploadFile(s),t=new FileReader;t.onload=e=>{Cs.value.avatar=e.target.result},t.readAsDataURL(s);const a=await ps.updateProfile({avatarUrl:e,nickname:Cs.value.nickname});a.success?(j.success("å¤´åƒæ›´æ–°æˆåŠŸ"),vs.user&&(vs.user.avatarUrl=e)):j.error(a.message||"å¤´åƒæ›´æ–°å¤±è´¥")}catch(t){console.error("å¤´åƒä¸Šä¼ å¤±è´¥:",t),j.error("å¤´åƒä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•")}e.target.value=""}else j.error("è¯·ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶")},ws=u(!1),Rs=u(Cs.value.nickname),xs=u(null),As=()=>{ws.value=!0,Rs.value=Cs.value.nickname,w(()=>{xs.value?.$el?.querySelector("input")?.focus()})},Ms=async()=>{if(Rs.value.trim())try{const e=await ps.updateProfile({nickname:Rs.value.trim(),avatarUrl:Cs.value.avatar});e.success?(Cs.value.nickname=Rs.value.trim(),vs.user&&(vs.user.nickname=Rs.value.trim()),j.success("æ˜µç§°æ›´æ–°æˆåŠŸ")):j.error(e.message||"æ˜µç§°æ›´æ–°å¤±è´¥")}catch(e){console.error("æ˜µç§°æ›´æ–°å¤±è´¥:",e),j.error("æ˜µç§°æ›´æ–°å¤±è´¥ï¼Œè¯·é‡è¯•")}else j.warning("æ˜µç§°ä¸èƒ½ä¸ºç©º");ws.value=!1};return(e,s)=>{const t=A,l=M,r=D,n=L,u=_;return d(),c("div",U,[v("div",P,[v("div",z,[v("div",I,[v("div",{class:"avatar-container",onClick:gs},[v("img",{src:Cs.value.avatar,alt:"",class:"user-avatar"},null,8,O)])]),v("input",{ref_key:"avatarInput",ref:bs,type:"file",accept:"image/*",class:"avatar-input",onChange:ks,hidden:""},null,544)]),v("div",V,[v("div",F,[v("div",S,[v("h1",{onClick:As,class:C(["user-name",{editable:!0}])},h(Cs.value.nickname),1),ws.value?(d(),c("div",T,[m(t,{modelValue:Rs.value,"onUpdate:modelValue":s[0]||(s[0]=e=>Rs.value=e),size:"large",onBlur:Ms,onKeyup:y(Ms,["enter"]),ref_key:"nameInput",ref:xs,placeholder:"Please enter a nickname"},null,8,["modelValue"])])):p("",!0)]),v("div",{class:C(["role-badge",Cs.value.role])},h("creator"===Cs.value.role?ds("roles.creator"):ds("roles.free")),3)]),v("div",B,h(Cs.value.email),1)])]),v("div",q,[v("h2",null,h(e.$t("userCenter.points.title")),1),v("div",J,[v("div",K,[v("div",Q,[s[5]||(s[5]=v("span",{class:"total-icon"},"ðŸª„",-1)),v("span",W,h(e.$t("userCenter.points.currentPoints")),1),v("span",E,h(fs.value),1),m(l,{type:"primary",size:"default",class:"recharge-btn",onClick:s[1]||(s[1]=e=>b(os).push("/points-recharge"))},{default:$(()=>[f(h(e.$t("userCenter.points.recharge")),1)]),_:1})]),v("div",null,[v("div",G,[(d(!0),c(g,null,k(Cs.value.pointsList,(t,a)=>(d(),c("div",{key:a,class:"points-item"},[v("div",H,[s[6]||(s[6]=v("span",{class:"points-icon"},"ðŸª„",-1)),v("span",N,h(t.points),1)]),v("div",X,[v("span",Y,h(e.$t("userCenter.points.expiryDate"))+"ï¼š",1),v("span",Z,h(t.expiryDate),1)])]))),128))])])]),v("div",ee,[v("div",se,[v("table",te,[v("thead",null,[v("tr",null,[v("th",null,h(e.$t("userCenter.points.consumptionRules.behavior")),1),v("th",null,h(e.$t("userCenter.points.consumptionRules.pointsConsumption")),1)])]),v("tbody",null,[v("tr",null,[v("td",null,h(e.$t("userCenter.points.consumptionRules.rules.generateImage")),1),v("td",null,"1 "+h(e.$t("pointsRecharge.points")),1)]),v("tr",null,[v("td",null,h(e.$t("userCenter.points.consumptionRules.rules.generateModel")),1),v("td",null,"30 "+h(e.$t("pointsRecharge.points")),1)])])])]),v("div",ae,[v("ul",null,[v("li",null,h(e.$t("userCenter.points.consumptionRules.additionalRules.rule1")),1),v("li",null,h(e.$t("userCenter.points.consumptionRules.additionalRules.rule2")),1),v("li",null,h(e.$t("userCenter.points.consumptionRules.additionalRules.rule3")),1)])])])])]),Cs.value.voucherList.length>0?(d(),c("div",le,[v("h2",null,h(e.$t("userCenter.voucher.title")),1),v("div",ie,[$s.value?(d(),c("div",re,[m(r,{rows:3,animated:""})])):0===Cs.value.voucherList.length?(d(),c("div",ne,[m(n,{description:e.$t("userCenter.voucher.empty")},null,8,["description"])])):(d(),c("div",ue,[(d(!0),c(g,null,k(Cs.value.voucherList,s=>(d(),c("div",{key:s.id,class:C(["voucher-card",["status-"+s.status]])},[v("div",oe,[v("div",ce,[v("span",de,h(s.currency),1),v("span",ve,h(s.amount),1)]),v("div",pe,h(s.statusDesc),1)]),v("div",me,[v("div",Ce,[v("div",he,h(s.couponCode),1),s.minOrderAmount>0?(d(),c("div",ye,h(e.$t("userCenter.voucher.minOrderAmount"))+": "+h(s.currency)+h(s.minOrderAmount),1)):p("",!0)]),v("div",$e,[v("span",fe,h(e.$t("userCenter.voucher.expireAt"))+":",1),v("span",be,h(new Date(s.expireAt).toLocaleDateString()),1)])])],2))),128))]))])])):p("",!0),Cs.value.inviteCodes.filter(e=>"permanent"!=e.codeType).length>0&&!b(a).isDomesticDomain()?(d(),c("div",ge,[v("h2",null,h(e.$t("userCenter.invitation.title")),1),v("div",ke,[v("div",we,[v("label",null,h(e.$t("userCenter.invitation.inviteCount")),1),v("span",null,h(Cs.value.inviteCount),1)])]),v("div",Re,[v("div",xe,[v("h3",null,h(e.$t("userCenter.invitation.inviteCodes")),1),m(l,{type:"primary",size:"default",class:"invite-details-btn",onClick:s[2]||(s[2]=e=>b(os).push("/user-center/invite-records"))},{default:$(()=>[f(h(e.$t("userCenter.invitation.inviteDetails")),1)]),_:1})]),v("div",Ae,[(d(!0),c(g,null,k(Cs.value.inviteCodes.filter(e=>"permanent"!=e.codeType),(s,t)=>(d(),c("div",{key:t,class:C(["invite-card",{used:s.used}])},[v("div",Me,[v("span",De,h(e.$t("userCenter.invitation.inviteCode")),1),s.used?(d(),c("span",Le,h(e.$t("userCenter.invitation.used")),1)):p("",!0)]),v("div",_e,h(s.code),1),v("div",je,[m(l,{type:"primary",size:"small",onClick:e=>(e=>{const s=`${window.location.origin}/#/register?inviteCode=${e}`,t=ds("userCenter.invitation.inviteLinkMessage",{code:e,url:s});i(t,()=>{j.success(ds("userCenter.invitation.copySuccess"))},()=>{j.error(ds("userCenter.invitation.copyFailed"))})})(s.code),disabled:s.used,class:C(["copy-btn"])},{default:$(()=>[f(h(e.$t("userCenter.invitation.copyCode")),1)]),_:1},8,["onClick","disabled"])])],2))),128))])]),v("div",Ue,[v("h3",null,h(e.$t("userCenter.invitation.rules.title")),1),v("div",Pe,[v("div",ze,[v("h4",null,h(e.$t("userCenter.invitation.rules.freeMember.title")),1),v("ul",null,[v("li",null,h(e.$t("userCenter.invitation.rules.freeMember.reward")),1),v("ul",null,[v("li",null,h(e.$t("userCenter.invitation.rules.freeMember.pointsReward")),1)])])]),v("div",Ie,[v("div",Oe,[v("h4",null,h(e.$t("userCenter.invitation.rules.creatorMember.title")),1),v("p",null,h(e.$t("userCenter.invitation.rules.creatorMember.whenInvite")),1),v("ol",null,[v("li",null,h(e.$t("userCenter.invitation.rules.creatorMember.permission")),1),v("li",null,h(e.$t("userCenter.invitation.rules.creatorMember.commissionAbility")),1),v("li",null,h(e.$t("userCenter.invitation.rules.creatorMember.immediateReward")),1),v("li",null,h(e.$t("userCenter.invitation.rules.creatorMember.binding")),1),v("li",null,h(e.$t("userCenter.invitation.rules.creatorMember.subsequentOrder")),1),v("li",null,h(e.$t("userCenter.invitation.rules.creatorMember.commissionRate")),1)])])])])])])):p("",!0),b(a).isPortraitDevice()?(d(),c("div",Ve)):p("",!0),m(u,{modelValue:ys.value,"onUpdate:modelValue":s[4]||(s[4]=e=>ys.value=e),title:e.$t("userCenter.voucher.detailTitle"),width:"600px"},{footer:$(()=>[v("span",us,[m(l,{onClick:s[3]||(s[3]=e=>ys.value=!1)},{default:$(()=>[f(h(e.$t("userCenter.voucher.close")),1)]),_:1})])]),default:$(()=>[v("div",Fe,[v("div",Se,[v("div",Te,h(e.$t("userCenter.voucher.couponCode")),1),v("div",Be,h(hs.value.couponCode),1)]),v("div",qe,[v("div",Je,h(e.$t("userCenter.voucher.amount")),1),v("div",Ke,[v("span",Qe,h(hs.value.currency),1),v("span",We,h(hs.value.amount),1)])]),v("div",Ee,[v("div",Ge,h(e.$t("userCenter.voucher.status")),1),v("div",He,h(hs.value.statusDesc),1)]),v("div",Ne,[v("div",Xe,h(e.$t("userCenter.voucher.minOrderAmount")),1),v("div",Ye,h(hs.value.currency)+h(hs.value.minOrderAmount),1)]),v("div",Ze,[v("div",es,h(e.$t("userCenter.voucher.expireAt")),1),v("div",ss,h(new Date(hs.value.expireAt).toLocaleString()),1)]),v("div",ts,[v("div",as,h(e.$t("userCenter.voucher.sourceDesc")),1),v("div",ls,h(hs.value.sourceDesc),1)]),v("div",is,[v("div",rs,h(e.$t("userCenter.voucher.createdAt")),1),v("div",ns,h(new Date(hs.value.createdAt).toLocaleString()),1)])])]),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-b9a4ee53"]]);export{os as default};
