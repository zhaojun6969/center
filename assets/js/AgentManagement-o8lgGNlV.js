import{r as e,d as a,_ as t,e as l}from"./index-7JqqWDD-.js";/* empty css                 */import{az as n,c as s,r as i,j as o,f as c,I as d,A as r,J as u,B as m,K as g,P as v,u as p,z as _,Q as f,a5 as y,O as h,R as M,aA as b,L as x,ah as k}from"./vendor-C2S3nqiJ.js";import{a0 as C,ac as z,F as T,C as V,I as w,n as A,E as j,U as S,Q as D,ad as U,R as F,d as I}from"./elementPlus-Dhv4F-aG.js";import{X as P}from"./xiaozhiserve-SRaAx1Sa.js";/* empty css                   */import"./utils-uaInoSqn.js";let L=class{constructor(){}async agentTemplateList(t){let l={page:t.page,page_size:t.pageSize};return t.templateType&&(l.template_type=String(t.templateType)),t.name&&(l.name=t.name),await e.common(a.xz_agent_template_list,l)}};const R={class:"template-dialog-content"},B={class:"filter-section"},K={class:"filter-label"},E={class:"filter-tags"},Q={class:"templates-grid"},W=["onClick"],X={class:"template-card-header"},$={class:"template-name"},J={class:"template-card-body"},O={class:"template-info-item"},q={class:"label"},G={class:"value"},H={class:"template-info-item"},N={class:"label"},Y={class:"value"},Z={class:"template-info-item"},ee={class:"label"},ae={class:"value"},te={class:"template-info-item"},le={class:"label"},ne={class:"value"},se={class:"dialog-footer"},ie=t({__name:"index",props:{visible:{type:Boolean,default:!1}},emits:["close","select"],setup(e,{emit:a}){const{t:t,locale:l}=n(),b=e,x=a,k=s({get:()=>b.visible,set:e=>{e||oe()}}),w=i("all"),A=i(!1),j=i([]),S=new L,D=s(()=>{const e=P.agentTemplateType(l.value);return[{label:t("agentManagement.allTypes"),value:"all"},{label:e[1],value:1},{label:e[2],value:2},{label:e[3],value:3},{label:e[4],value:4}]}),U=s(()=>j.value),F=async()=>{try{A.value=!0;const e={page:1,pageSize:100};"all"!==w.value&&(e.templateType=w.value);const a=await S.agentTemplateList(e);0===a.code&&(j.value=a.data.items||[])}catch(e){console.error("获取模板列表失败:",e)}finally{A.value=!1}},I=e=>P.agentTemplateType(l.value)[e]||"-",ie=e=>{if(!e)return"-";return{zh_male_dayi_saturn_bigtts:t("agentManagement.zhMaleDayi"),zh_female_xiaoxiao_saturn_bigtts:t("agentManagement.zhFemaleXiaoxiao"),zh_female_vv_uranus_bigtts:t("agentManagement.zhFemaleVv")}[e]||e},oe=()=>{x("close")};return o(()=>b.visible,e=>{e&&F()}),c(()=>{b.visible&&F()}),(e,a)=>{const l=C,n=T,s=V,i=z;return r(),d(s,{modelValue:k.value,"onUpdate:modelValue":a[0]||(a[0]=e=>k.value=e),title:p(t)("agentManagement.importAgentTemplate"),width:"90%",style:{maxWidth:"1000px"},center:"",onClose:oe},{footer:u(()=>[m("span",se,[M(n,{onClick:oe},{default:u(()=>[h(v(p(t)("common.cancel")),1)]),_:1})])]),default:u(()=>[m("div",R,[m("div",B,[m("div",K,v(p(t)("agentManagement.templateType"))+":",1),m("div",E,[(r(!0),_(f,null,y(D.value,e=>(r(),d(l,{key:e.value,type:w.value===e.value?"primary":"info",effect:w.value===e.value?"dark":"plain",class:"filter-tag",onClick:a=>(e=>{w.value=e,F()})(e.value)},{default:u(()=>[h(v(e.label),1)]),_:2},1032,["type","effect","onClick"]))),128))])]),g((r(),_("div",Q,[(r(!0),_(f,null,y(U.value,e=>{return r(),_("div",{key:e.id,class:"template-card",onClick:a=>(e=>{x("select",e),oe()})(e)},[m("div",X,[m("h3",$,v(e.name),1),M(l,{size:"small",type:(n=e.template_type,{1:"success",2:"danger",3:"warning",4:"info"}[n]||"info")},{default:u(()=>[h(v(I(e.template_type)),1)]),_:2},1032,["type"])]),m("div",J,[m("div",O,[m("span",q,v(p(t)("agentManagement.character"))+":",1),m("span",G,v(e.ext_data?.character||"-"),1)]),m("div",H,[m("span",N,v(p(t)("agentManagement.llmModel"))+":",1),m("span",Y,v(e.ext_data?.llm_model||"-"),1)]),m("div",Z,[m("span",ee,v(p(t)("agentManagement.language"))+":",1),m("span",ae,v((a=e.ext_data?.language,{zh:t("agentManagement.zh"),en:t("agentManagement.en")}[a]||"-")),1)]),m("div",te,[m("span",le,v(p(t)("agentManagement.ttsVoice"))+":",1),m("span",ne,v(ie(e.ext_data?.tts_voice)),1)])])],8,W);var a,n}),128))])),[[i,A.value]])])]),_:1},8,["modelValue","title"])}}},[["__scopeId","data-v-75d38562"]]),oe={class:"agent-management"},ce={class:"page-header"},de={class:"header-content"},re={class:"header-actions"},ue={class:"search-container"},me={class:"agents-section"},ge={class:"agents-grid"},ve={class:"agent-card-header"},pe={class:"agent-name"},_e={class:"agent-actions"},fe={class:"agent-card-body"},ye={class:"agent-info-item"},he={class:"label"},Me={class:"value"},be={class:"agent-info-item"},xe={class:"label"},ke={class:"value"},Ce={key:0,class:"agent-info-item"},ze={class:"label"},Te=["onClick"],Ve={key:1,class:"loading-container"},we={class:"loading-text"},Ae={key:2,class:"empty-container"},je={class:"empty-content"},Se={class:"empty-text"},De={class:"bind-dialog-content"},Ue={class:"dialog-footer"},Fe={class:"delete-dialog-content"},Ie={class:"delete-warning"},Pe={class:"dialog-footer"},Le={key:0,style:{height:"60px"}},Re=t({__name:"AgentManagement",setup(e){const{t:a}=n(),t=b(),s=new P,o=i(!1),d=i(!1),g=i(!1),C=i(""),z=i(""),L=i(""),R=i(""),B=i([]),K=i(!1),E=i(1),Q=i(10),W=i(!0),X=async()=>{if(W.value)try{K.value=!0;const e={user_id:"",agent_name:R.value,sync_status:"",page:E.value,page_size:Q.value},a=await s.listAgent(e);if(0===a.code&&a.data){const e=a.data.items||[];1===E.value?B.value=e:B.value=[...B.value,...e];const t=a.data.total||0;W.value=B.value.length<t,E.value++}else I.error(a.msg||"获取智能体列表失败")}catch(e){console.error("获取智能体列表出错:",e),I.error("获取智能体列表失败")}finally{K.value=!1}},$=()=>{X()},J=e=>{C.value=e.replace(/[^0-9]/g,"").slice(0,6)},O=()=>{o.value=!1,C.value="",z.value="",L.value=""},q=async()=>{if(6===C.value.length){try{K.value=!0;const e={agent_id:L.value,verification_code:C.value},a=await s.addDeviceAgent(e);console.log("addDeviceAgent响应结果:",a),0===a.code?(I.success("设备绑定成功！"),G()):I.error(a.msg||"设备绑定失败")}catch(e){console.error("设备绑定出错:",e),I.error("设备绑定失败")}finally{K.value=!1}O()}},G=()=>{B.value=[],E.value=1,W.value=!0,K.value=!1,X()},H=()=>{d.value=!1,z.value="",L.value=""},N=async()=>{try{K.value=!0;const e={id:L.value};0===(await s.deleteAgent(e)).code?I.success("success"):I.error("err"),G()}catch(e){console.error("删除智能体出错:",e),I.error("智能体删除失败")}finally{K.value=!1}H()},Y=()=>{t.push("/add-agent")},Z=()=>{g.value=!0},ee=async e=>{try{K.value=!0;const t={agent_name:e.ext_data?.agent_name||e.name,assistant_name:e.ext_data?.assistant_name,llm_model:e.ext_data?.llm_model,tts_voice:e.ext_data?.tts_voice,tts_speech_speed:e.ext_data?.tts_speech_speed,tts_pitch:e.ext_data?.tts_pitch,asr_speed:e.ext_data?.asr_speed,language:e.ext_data?.language,character:e.ext_data?.character,memory:e.ext_data?.memory,memory_type:e.ext_data?.memory_type,mcp_endpoints:e.ext_data?.mcp_endpoints||[],knowledge_base_ids:e.ext_data?.knowledge_base_ids||[]},l=await s.createAgent(t);0===l.code?(I.success(a("agentManagement.importTemplateSuccess")),G()):I.error(l.msg||a("agentManagement.importTemplateFailed"))}catch(t){console.error("导入智能体模板出错:",t),I.error(a("agentManagement.importTemplateFailed"))}finally{K.value=!1}},ae=e=>{G()};return c(()=>{G()}),(e,n)=>{const s=w,i=j,c=T,b=V,I=F;return r(),_(f,null,[M(I,{height:"100%",onEndReached:$},{default:u(()=>[m("div",oe,[m("div",ce,[m("div",de,[n[5]||(n[5]=m("h1",{class:"page-title"},null,-1)),m("div",re,[m("div",ue,[M(s,{modelValue:R.value,"onUpdate:modelValue":n[0]||(n[0]=e=>R.value=e),placeholder:p(a)("agentManagement.searchPlaceholder"),"prefix-icon":p(A),clearable:"",onKeyup:k(ae,["enter"]),size:"default"},null,8,["modelValue","placeholder","prefix-icon"])]),M(c,{type:"default",onClick:Z},{default:u(()=>[M(i,null,{default:u(()=>[M(p(S))]),_:1}),h(" "+v(p(a)("agentManagement.importAgentTemplate")),1)]),_:1}),M(c,{type:"primary",onClick:Y},{default:u(()=>[M(i,null,{default:u(()=>[M(p(D))]),_:1}),h(" "+v(p(a)("agentManagement.addAgent")),1)]),_:1})])])]),m("div",me,[m("div",ge,[B.value.length>0?(r(!0),_(f,{key:0},y(B.value,e=>(r(),_("div",{class:"agent-card",key:e.id},[m("div",ve,[m("h3",pe,v(e.agent_name||p(a)("agentManagement.unnamedAgent")),1),m("div",_e,[M(c,{size:"small",onClick:a=>{return l=e.id,console.log("编辑智能体:",l),void t.push(`/add-agent?id=${l}`);var l}},{default:u(()=>[h(v(p(a)("agentManagement.editAgent")),1)]),_:1},8,["onClick"]),M(c,{type:"primary",size:"small",onClick:a=>{return t=e.id,l=e.agent_name,z.value=l,L.value=t,o.value=!0,void(C.value="");var t,l}},{default:u(()=>[h(v(e.sync_status?p(a)("agentManagement.rebindDevice"):p(a)("agentManagement.bindDevice")),1)]),_:2},1032,["onClick"]),M(c,{type:"danger",size:"small",onClick:a=>{return t=e.id,l=e.agent_name,z.value=l,L.value=t,void(d.value=!0);var t,l}},{default:u(()=>[h(v(p(a)("agentManagement.deleteAgent")),1)]),_:1},8,["onClick"])])]),m("div",fe,[m("div",ye,[m("span",he,v(p(a)("agentManagement.character"))+"：",1),m("span",Me,v(e.character||p(a)("agentManagement.notSet")),1)]),m("div",be,[m("span",xe,v(p(a)("agentManagement.llmModel"))+"：",1),m("span",ke,v(e.llm_model||p(a)("agentManagement.notSet")),1)]),e.device_count>0?(r(),_("div",Ce,[m("span",ze,v(p(a)("agentManagement.deviceCount"))+"：",1),m("span",{class:"value device-count-link",onClick:a=>{return l=e.id,console.log("查看设备列表:",l),void t.push(`/device-list/${l}`);var l}},v(e.device_count)+" "+v(p(a)("agentManagement.devices")),9,Te)])):x("",!0)])]))),128)):x("",!0),K.value&&0===B.value.length?(r(),_("div",Ve,[m("div",we,v(p(a)("agentManagement.loading")),1)])):x("",!0),K.value||0!==B.value.length?x("",!0):(r(),_("div",Ae,[m("div",je,[M(i,{size:"64"},{default:u(()=>[M(p(U))]),_:1}),m("p",Se,v(p(a)("agentManagement.noAgents")),1)])]))]),M(b,{modelValue:o.value,"onUpdate:modelValue":n[2]||(n[2]=e=>o.value=e),title:p(a)("agentManagement.bindDeviceTitle"),width:"400px",center:""},{footer:u(()=>[m("span",Ue,[M(c,{onClick:O},{default:u(()=>[h(v(p(a)("common.cancel")),1)]),_:1}),M(c,{type:"primary",onClick:q,disabled:6!==C.value.length},{default:u(()=>[h(v(p(a)("agentManagement.confirmBind")),1)]),_:1},8,["disabled"])])]),default:u(()=>[m("div",De,[m("p",null,v(p(a)("agentManagement.enterVerificationCode")),1),M(s,{modelValue:C.value,"onUpdate:modelValue":n[1]||(n[1]=e=>C.value=e),key:"verification_code",placeholder:p(a)("agentManagement.verificationCodePlaceholder"),maxlength:"6","show-word-limit":"",onInput:J,onKeyup:k(q,["enter"])},null,8,["modelValue","placeholder"])])]),_:1},8,["modelValue","title"]),M(b,{modelValue:d.value,"onUpdate:modelValue":n[3]||(n[3]=e=>d.value=e),title:p(a)("agentManagement.deleteConfirmTitle"),width:"400px",center:""},{footer:u(()=>[m("span",Pe,[M(c,{onClick:H},{default:u(()=>[h(v(p(a)("common.cancel")),1)]),_:1}),M(c,{type:"danger",onClick:N},{default:u(()=>[h(v(p(a)("common.delete")),1)]),_:1})])]),default:u(()=>[m("div",Fe,[m("p",null,v(p(a)("agentManagement.deleteConfirmContent")),1),m("p",Ie,v(p(a)("agentManagement.deleteWarning")),1)])]),_:1},8,["modelValue","title"])])]),p(l).isPortraitDevice()?(r(),_("div",Le)):x("",!0)]),_:1}),M(ie,{visible:g.value,onClose:n[4]||(n[4]=e=>g.value=!1),onSelect:ee},null,8,["visible"])],64)}}},[["__scopeId","data-v-4bc1b755"]]);export{Re as default};
