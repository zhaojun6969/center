import{_ as e,u as a,T as l,L as s}from"./index-C1ozWA1l.js";import{ax as r,r as i,j as o,z as t,A as d,B as u,L as n,P as v,u as c,E as p,K as m,ai as g,R as f,J as _,X as b,c as y,aK as C,I as k,W as w,f as h,aB as x,aA as V,O as I}from"./vendor-p2oL7ibe.js";import{I as B,E as j,J as q,K as F,d as S,P as U}from"./elementPlus-MWeHapXo.js";import{L as A}from"./login-CBmXs1ii.js";/* empty css                   */const E={class:"invite-code-section"},R={class:"form-group"},K={class:"form-label",for:"inviteCode"},L=["placeholder","disabled"],P={key:0,class:"input-error-icon"},J={key:0,class:"error-message"},$=e({__name:"InviteCodeInput",props:{modelValue:{type:String,default:""},error:{type:String,default:""},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","validate"],setup(e,{emit:a}){const l=e,s=a,{t:b}=r(),y=i(!1),C=i(l.modelValue);return o(()=>l.modelValue,e=>{C.value=e}),o(C,e=>{s("update:modelValue",e),s("validate",e)}),(a,l)=>{const s=j;return d(),t("div",E,[u("div",R,[u("label",K,v(c(b)("login.invite_code_label")),1),u("div",{class:p(["input-wrapper",{focused:y.value}])},[m(u("input",{id:"inviteCode","onUpdate:modelValue":l[0]||(l[0]=e=>C.value=e),type:"text",class:p(["form-input",{error:e.error}]),placeholder:c(b)("login.invite_code_placeholder"),onFocus:l[1]||(l[1]=e=>y.value=!0),onBlur:l[2]||(l[2]=e=>y.value=!1),disabled:e.disabled,autocomplete:"off"},null,42,L),[[g,C.value]]),e.error?(d(),t("div",P,[f(s,null,{default:_(()=>[f(c(B))]),_:1})])):n("",!0)],2),e.error?(d(),t("div",J,v(e.error),1)):n("",!0)])])}}},[["__scopeId","data-v-f196bc10"]]),z={class:"form-group"},D={class:"form-label",for:"email"},O=["placeholder","disabled"],T={key:0,class:"input-error-icon"},W={key:0,class:"error-message"},X={class:"form-group"},G={class:"form-label",for:"verificationCode"},H={class:"verification-wrapper"},M=["placeholder","disabled"],N={key:0,class:"input-error-icon"},Q=["disabled"],Y={key:0},Z={key:1},ee={key:2},ae={key:0,class:"error-message"},le={class:"form-group"},se={class:"form-label",for:"password"},re=["type","placeholder","disabled"],ie=["disabled"],oe={key:0,class:"error-message"},te={class:"form-group"},de={key:0,class:"error-message"},ue=["disabled"],ne={class:"button-text"},ve={key:0},ce={key:1},pe={key:0,class:"loading-spinner"},me=e({__name:"RegisterForm",props:{loading:{type:Boolean,default:!1},inviteCode:{type:String,default:""}},emits:["success","error"],setup(e,{emit:a}){const{t:l}=r(),s=new A,h=a,x=e,V=i({email:"",password:"",verificationCode:"",inviteCode:""}),I=i(!1),U=i(!1),E=i(!1),R=i(!1),K=i(!1),L=i(0);let P=null;b(()=>{P&&(clearInterval(P),P=null)});const J=i(""),me=i(""),ge=i(""),fe=i(""),_e=y(()=>V.value.email&&V.value.password&&V.value.verificationCode&&V.value.inviteCode&&!J.value&&!me.value&&!ge.value&&!fe.value),be=y(()=>V.value.email&&!J.value),ye=async()=>{if(be.value&&!K.value){K.value=!0;try{s.sendEmailCode({email:V.value.email,purpose:"register"},()=>{L.value=60,P=setInterval(()=>{L.value>0?L.value--:(clearInterval(P),P=null)},1e3)})}catch(e){S.error(l("register.verification_code_send_failed"))}finally{K.value=!1}}},Ce=()=>{V.value.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(V.value.email)?J.value="":J.value=l("register.email_invalid_error"):J.value=l("register.email_empty_error")},ke=()=>{V.value.password?V.value.password.length<6?me.value=l("register.password_min_error"):me.value="":me.value=l("register.password_empty_error")},we=()=>{V.value.verificationCode?/^\d{6}$/.test(V.value.verificationCode)?ge.value="":ge.value=l("register.verification_code_invalid_error"):ge.value=l("register.verification_code_empty_error")},he=()=>{V.value.inviteCode?fe.value="":fe.value=l("register.invite_code_empty_error")};o(()=>V.value.email,Ce),o(()=>V.value.password,ke),o(()=>V.value.verificationCode,we),o(()=>V.value.inviteCode,he),o(()=>x.inviteCode,e=>{e&&(V.value.inviteCode=e)},{immediate:!0});const xe=()=>{V.value.email&&V.value.password&&V.value.verificationCode&&V.value.inviteCode&&s.confirmRegister({email:V.value.email,emailCode:V.value.verificationCode,password:V.value.password,inviteCode:V.value.inviteCode},()=>{h("success")})};return(a,s)=>{const r=j;return d(),t("form",{class:"register-form",onSubmit:w(xe,["prevent"])},[u("div",z,[u("label",D,v(c(l)("register.email_label")),1),u("div",{class:p(["input-wrapper",{focused:I.value}])},[m(u("input",{id:"email","onUpdate:modelValue":s[0]||(s[0]=e=>V.value.email=e),type:"email",class:p(["form-input",{error:J.value}]),placeholder:c(l)("register.email_placeholder"),onFocus:s[1]||(s[1]=e=>I.value=!0),onBlur:Ce,disabled:e.loading,autocomplete:"email"},null,42,O),[[g,V.value.email]]),J.value?(d(),t("div",T,[f(r,null,{default:_(()=>[f(c(B))]),_:1})])):n("",!0)],2),J.value?(d(),t("div",W,v(J.value),1)):n("",!0)]),u("div",X,[u("label",G,v(c(l)("register.verification_code_label")),1),u("div",H,[u("div",{class:p(["input-wrapper",{focused:E.value}])},[m(u("input",{id:"verificationCode","onUpdate:modelValue":s[2]||(s[2]=e=>V.value.verificationCode=e),type:"text",class:p(["form-input verification-input",{error:ge.value}]),placeholder:c(l)("register.verification_code_placeholder"),onFocus:s[3]||(s[3]=e=>E.value=!0),onBlur:we,disabled:e.loading,maxlength:"6",autocomplete:"off"},null,42,M),[[g,V.value.verificationCode]]),ge.value?(d(),t("div",N,[f(r,null,{default:_(()=>[f(c(B))]),_:1})])):n("",!0)],2),u("button",{type:"button",class:p(["send-code-button",{"countdown-active":L.value>0}]),onClick:ye,disabled:K.value||L.value>0},[L.value>0?(d(),t("span",Y,v(L.value)+"s",1)):K.value?(d(),t("span",Z,v(c(l)("register.sending_code")),1)):(d(),t("span",ee,v(c(l)("register.send_code")),1))],10,Q)]),ge.value?(d(),t("div",ae,v(ge.value),1)):n("",!0)]),u("div",le,[u("label",se,v(c(l)("register.password_label")),1),u("div",{class:p(["input-wrapper",{focused:U.value}])},[m(u("input",{id:"password","onUpdate:modelValue":s[4]||(s[4]=e=>V.value.password=e),type:R.value?"text":"password",class:p(["form-input",{error:me.value}]),placeholder:c(l)("register.password_placeholder"),onFocus:s[5]||(s[5]=e=>U.value=!0),onBlur:ke,disabled:e.loading,autocomplete:"new-password"},null,42,re),[[C,V.value.password]]),u("button",{type:"button",class:"password-toggle",onClick:s[6]||(s[6]=e=>R.value=!R.value),disabled:e.loading},[R.value?(d(),k(r,{key:0},{default:_(()=>[f(c(q))]),_:1})):(d(),k(r,{key:1},{default:_(()=>[f(c(F))]),_:1}))],8,ie)],2),me.value?(d(),t("div",oe,v(me.value),1)):n("",!0)]),u("div",te,[f($,{modelValue:V.value.inviteCode,"onUpdate:modelValue":s[7]||(s[7]=e=>V.value.inviteCode=e),error:fe.value,disabled:e.loading,onValidate:he},null,8,["modelValue","error","disabled"]),fe.value?(d(),t("div",de,v(fe.value),1)):n("",!0)]),u("button",{type:"submit",class:"register-submit-button",disabled:e.loading||!_e.value},[u("span",ne,[e.loading?(d(),t("span",ce,v(c(l)("register.registering")),1)):(d(),t("span",ve,v(c(l)("register.register_button")),1))]),e.loading?(d(),t("div",pe)):n("",!0)],8,ue)],32)}}},[["__scopeId","data-v-3a413560"]]),ge={class:"register-page"},fe={class:"top-right-controls"},_e={class:"controls-container"},be={class:"register-container"},ye={class:"register-card"},Ce={class:"back-to-login"},ke={class:"register-header"},we={class:"register-title"},he={class:"register-subtitle"},xe={class:"register-form-section"},Ve={class:"login-prompt"},Ie={class:"prompt-text"},Be={key:0,class:"error-message"},je=e({__name:"Register",setup(e){const o=V(),p=x(),m=a(),{t:g}=r(),b=i("");h(()=>{const e=p.query.inviteCode;e&&(b.value=e)});const y=e=>{const a=p.query;o.replace({name:"login",query:a})},C=e=>{},k=()=>{const e=p.query;o.replace({name:"login",query:e})};return h(()=>{m.isAuthenticated&&(m.isCreator?o.push("/creator"):m.isAdmin?o.push("/admin"):o.push("/dashboard"))}),(e,a)=>{const r=j;return d(),t("div",ge,[a[0]||(a[0]=u("div",{class:"register-background"},null,-1)),u("div",fe,[u("div",_e,[f(l,{position:"top-right","tooltip-text":c(g)("register.theme_toggle_tooltip")},null,8,["tooltip-text"]),f(s,{position:"top-right","tooltip-text":c(g)("register.language_toggle_tooltip")},null,8,["tooltip-text"])])]),u("div",be,[u("div",ye,[u("div",Ce,[u("button",{onClick:k,class:"back-link"},[f(r,{class:"back-icon"},{default:_(()=>[f(c(U))]),_:1}),I(" "+v(c(g)("register.back_to_login")),1)])]),u("div",ke,[u("h1",we,v(c(g)("register.title")),1),u("p",he,v(c(g)("register.subtitle")),1)]),u("div",xe,[f(me,{onSuccess:y,onError:C,loading:c(m).loading,inviteCode:b.value},null,8,["loading","inviteCode"])]),u("div",Ve,[u("span",Ie,v(c(g)("register.has_account")),1),u("button",{onClick:k,class:"login-link"},v(c(g)("register.login_now")),1)]),c(m).error?(d(),t("div",Be,[f(r,{class:"error-icon"},{default:_(()=>[f(c(B))]),_:1}),u("span",null,v(c(m).error),1)])):n("",!0)])])])}}},[["__scopeId","data-v-b492965e"]]);export{je as default};
