import{_ as s,T as o,L as e}from"./index-C1ozWA1l.js";import{al as a,z as t,A as i,B as n,L as r,W as l,P as d,K as c,ai as u,E as w,Q as p,O as f,a5 as m,aK as g,R as v,J as b,I as P,ax as h,l as y,r as C,c as _,ae as k,n as S,f as I,aA as D,u as V}from"./vendor-p2oL7ibe.js";import{Q as K,K as x,J as E,E as j,d as U,P as q}from"./elementPlus-MWeHapXo.js";import{L as F}from"./login-CBmXs1ii.js";const L={class:"forgot-password-form"},A={class:"form-container"},B={class:"form-group"},H={class:"form-label"},J={class:"input-group"},Q=["placeholder"],R=["disabled"],$={key:1,class:"loading-dots"},z={class:"form-group verification-group"},O={class:"form-label"},T={class:"verification-code-input"},W=["onUpdate:modelValue","onInput","onKeydown"],G={class:"verification-hint"},M={class:"form-group"},N={class:"form-label"},X={class:"password-input-group"},Y=["type","placeholder"],Z={class:"form-group"},ss={class:"form-label"},os={class:"password-input-group"},es=["type","placeholder"],as=["disabled"],ts={key:1,class:"success-message"},is={class:"success-title"},ns={class:"success-description"};const rs=s({name:"ForgotPasswordForm",emits:["reset-success"],components:{View:E,Hide:x,Key:K},setup(s,{emit:o}){let e=new F;const{t:a}=h(),t=y({email:"",verificationCode:"",verificationDigits:["","","","","",""],newPassword:"",confirmPassword:"",showPassword:!1,showConfirmPassword:!1,isSubmitting:!1,isSendingCode:!1,showSuccess:!1,codeCountdown:0,countdownInterval:null}),i=C([]),n=_(()=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email)),r=()=>t.email?!!n.value||(U.error(a("forgotPassword.email_invalid_error")),!1):(U.error(a("forgotPassword.email_empty_error")),!1),l=(s=60)=>{t.codeCountdown=s,t.countdownInterval=setInterval(()=>{t.codeCountdown>0?t.codeCountdown--:clearInterval(t.countdownInterval)},1e3)},d=_(()=>6===t.verificationDigits.join("").length&&t.newPassword.length>=6&&t.confirmPassword.length>=6&&t.newPassword===t.confirmPassword);return{...k(t),t:a,isEmailValid:n,canSubmit:d,verificationInputs:i,handleEmailInput:()=>{},handleSendCode:async()=>{if(r()){t.isSendingCode=!0;try{e.sendEmailCode({email:t.email,purpose:"forgot-password"},()=>{l(),i.value[0]?.focus()})}catch(s){}finally{t.isSendingCode=!1}}},handleSubmit:async()=>{if(!r())return;const s=t.verificationDigits.join("");if(s&&6===s.length){t.isSubmitting=!0;try{e.confirmForgotPassword({email:t.email,emailCode:s,password:t.newPassword},()=>{o("reset-success",t.email)})}catch(i){}finally{t.isSubmitting=!1}}else U.error(a("forgotPassword.verification_code_empty_error"))},handleCodeInput:async(s,o)=>{const e=o.target.value.replace(/\D/g,"");e&&(t.verificationDigits[s]=e,t.verificationCode=t.verificationDigits.join(""),s<5&&e&&(await S(),i.value[s+1]?.focus()))},handleCodeKeydown:async(s,o)=>{"Backspace"===o.key&&!t.verificationDigits[s]&&s>0&&(await S(),i.value[s-1]?.focus())},handleCodePaste:async s=>{s.preventDefault();const o=s.clipboardData.getData("text").replace(/\D/g,"");if(6===o.length){for(let s=0;s<6;s++)t.verificationDigits[s]=o[s];t.verificationCode=o,await S(),i.value[5]?.focus()}},togglePasswordVisibility:()=>{t.showPassword=!t.showPassword},toggleConfirmPasswordVisibility:()=>{t.showConfirmPassword=!t.showConfirmPassword},cleanup:()=>{t.countdownInterval&&clearInterval(t.countdownInterval)}}},unmounted(){this.cleanup()}},[["render",function(s,o,e,h,y,C){const _=a("View"),k=a("Hide"),S=j,I=a("Key"),D=a("router-link");return i(),t("div",L,[n("div",A,[s.showSuccess?r("",!0):(i(),t("form",{key:0,onSubmit:o[8]||(o[8]=l((...s)=>h.handleSubmit&&h.handleSubmit(...s),["prevent"])),class:"form-content"},[n("div",B,[n("label",H,d(h.t("forgotPassword.email_label")),1),n("div",J,[c(n("input",{"onUpdate:modelValue":o[0]||(o[0]=o=>s.email=o),type:"email",class:"form-input",placeholder:h.t("forgotPassword.email_placeholder"),required:"",onInput:o[1]||(o[1]=(...s)=>h.handleEmailInput&&h.handleEmailInput(...s))},null,40,Q),[[u,s.email]]),n("button",{type:"button",onClick:o[2]||(o[2]=(...s)=>h.handleSendCode&&h.handleSendCode(...s)),class:w(["send-code-button",{"countdown-active":s.codeCountdown>0}]),disabled:!h.isEmailValid||s.isSendingCode||s.codeCountdown>0},[s.codeCountdown>0?(i(),t(p,{key:0},[f(d(s.codeCountdown)+"s",1)],64)):s.isSendingCode?(i(),t("span",$,[...o[9]||(o[9]=[n("span",null,null,-1),n("span",null,null,-1),n("span",null,null,-1)])])):(i(),t(p,{key:2},[f(d(h.t("forgotPassword.send_code")),1)],64))],10,R)])]),n("div",z,[n("label",O,d(h.t("forgotPassword.verification_code_label")),1),n("div",T,[(i(!0),t(p,null,m(s.verificationDigits,(e,a)=>c((i(),t("input",{key:a,ref_for:!0,ref:s=>h.verificationInputs[a]=s,"onUpdate:modelValue":o=>s.verificationDigits[a]=o,type:"text",class:"code-digit-input",maxlength:"1",pattern:"[0-9]",inputmode:"numeric",onInput:s=>h.handleCodeInput(a,s),onKeydown:s=>h.handleCodeKeydown(a,s),onPaste:o[3]||(o[3]=(...s)=>h.handleCodePaste&&h.handleCodePaste(...s)),required:""},null,40,W)),[[u,s.verificationDigits[a]]])),128))]),n("p",G,d(h.t("forgotPassword.verification_hint")),1)]),n("div",M,[n("label",N,d(h.t("forgotPassword.new_password_label")),1),n("div",X,[c(n("input",{"onUpdate:modelValue":o[4]||(o[4]=o=>s.newPassword=o),type:s.showPassword?"text":"password",class:"form-input",placeholder:h.t("forgotPassword.new_password_placeholder"),required:"",minlength:"6"},null,8,Y),[[g,s.newPassword]]),n("button",{type:"button",onClick:o[5]||(o[5]=(...s)=>h.togglePasswordVisibility&&h.togglePasswordVisibility(...s)),class:w(["password-toggle",{visible:s.showPassword}])},[v(S,null,{default:b(()=>[s.showPassword?r("",!0):(i(),P(_,{key:0})),s.showPassword?(i(),P(k,{key:1})):r("",!0)]),_:1})],2)])]),n("div",Z,[n("label",ss,d(h.t("forgotPassword.confirm_password_label")),1),n("div",os,[c(n("input",{"onUpdate:modelValue":o[6]||(o[6]=o=>s.confirmPassword=o),type:s.showConfirmPassword?"text":"password",class:"form-input",placeholder:h.t("forgotPassword.confirm_password_placeholder"),required:"",minlength:"6"},null,8,es),[[g,s.confirmPassword]]),n("button",{type:"button",onClick:o[7]||(o[7]=(...s)=>h.toggleConfirmPasswordVisibility&&h.toggleConfirmPasswordVisibility(...s)),class:w(["password-toggle",{visible:s.showConfirmPassword}])},[v(S,null,{default:b(()=>[s.showConfirmPassword?r("",!0):(i(),P(_,{key:0})),s.showConfirmPassword?(i(),P(k,{key:1})):r("",!0)]),_:1})],2)])]),n("button",{type:"submit",class:w(["submit-button reset-confirm-button",{loading:s.isSubmitting}]),disabled:!h.canSubmit||s.isSubmitting},[s.isSubmitting?(i(),t(p,{key:0},[o[10]||(o[10]=n("span",{class:"loading-dots"},[n("span"),n("span"),n("span")],-1)),f(" "+d(h.t("forgotPassword.resetting")),1)],64)):(i(),t(p,{key:1},[v(S,null,{default:b(()=>[v(I)]),_:1}),f(" "+d(h.t("forgotPassword.reset_password")),1)],64))],10,as)],32)),s.showSuccess?(i(),t("div",ts,[o[11]||(o[11]=n("div",{class:"success-icon"},"âœ“",-1)),n("h3",is,d(h.t("forgotPassword.reset_success_title")),1),n("p",ns,d(h.t("forgotPassword.reset_success_description")),1),v(D,{to:"/login",class:"login-redirect-button"},{default:b(()=>[f(d(h.t("forgotPassword.go_to_login")),1)]),_:1})])):r("",!0)])])}],["__scopeId","data-v-3305edab"]]),ls={class:"forgot-password-page"},ds={class:"top-controls"},cs={class:"main-card"},us={class:"back-section"},ws={class:"form-section"},ps={class:"form-content"},fs=s({__name:"ForgotPassword",setup(s){const a=D(),{t:r}=h(),l=C(""),c=s=>{l.value=s,a.back()},u=()=>{a.back()};return I(()=>{}),(s,a)=>{const r=j;return i(),t("div",ls,[a[0]||(a[0]=n("div",{class:"background-decoration"},[n("div",{class:"gradient-orb orb-1"}),n("div",{class:"gradient-orb orb-2"}),n("div",{class:"gradient-orb orb-3"})],-1)),n("div",ds,[v(o),v(e)]),n("div",cs,[n("div",us,[n("view",{onClick:u,class:"back-button"},[v(r,null,{default:b(()=>[v(V(q))]),_:1}),n("span",null,d(s.$t("forgotPassword.back_to_login")),1)])]),n("div",ws,[n("div",ps,[v(rs,{onResetSuccess:c})])])])])}}},[["__scopeId","data-v-05d23434"]]);export{fs as default};
