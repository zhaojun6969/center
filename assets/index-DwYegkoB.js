import{_ as e,W as s,u as t,e as a,F as l,h as i}from"./index-CqnzwUr8.js";/* empty css                   *//* empty css                 *//* empty css                    *//* empty css                         *//* empty css                 */import{aA as n,ax as r,r as u,f as o,z as c,A as d,B as v,L as p,R as m,E as C,P as h,ah as y,J as $,O as f,u as b,Q as g,a5 as k,n as w}from"./vendor-p2oL7ibe.js";import{U as x}from"./index-HB33SN3l.js";import{M as R}from"./index-CxyUPh15.js";import{C as A,y as L,a9 as M,aa as D,z as _,d as j}from"./elementPlus-DzXnjnIh.js";const U={class:"user-center-container"},z={class:"user-info-section"},O={class:"user-avatar-section"},P={class:"avatar-wrapper"},V=["src"],S={class:"user-details-section"},T={class:"user-name-row"},I={class:"editable-name-container"},F={key:0,class:"name-edit-form"},B={class:"user-email"},q={class:"points-section"},J={class:"points-content-container"},K={class:"points-list"},W={class:"total-points"},E={class:"total-label"},H={class:"points-value"},N={class:"points-items"},Q={class:"points-item-left"},G={class:"points-number"},X={class:"points-item-right"},Y={class:"expiry-label"},Z={class:"expiry-date"},ee={class:"points-consumption-rules"},se={class:"rules-table-container"},te={class:"points-rules-table"},ae={class:"additional-rules"},le={key:0,class:"voucher-section"},ie={class:"voucher-list-container"},ne={key:0,class:"loading-container"},re={key:1,class:"empty-vouchers"},ue={key:2,class:"voucher-grid"},oe={class:"voucher-header"},ce={class:"voucher-amount"},de={class:"currency"},ve={class:"amount"},pe={class:"voucher-status"},me={class:"voucher-body"},Ce={class:"voucher-info"},he={class:"voucher-code"},ye={key:0,class:"voucher-min-order"},$e={class:"voucher-expiry"},fe={class:"expiry-label"},be={class:"expiry-date"},ge={key:1,class:"invitation-section"},ke={class:"invitation-info"},we={class:"info-item"},xe={class:"invite-codes-section"},Re={class:"section-header"},Ae={class:"invite-cards-container"},Le={class:"card-header"},Me={class:"card-title"},De={key:0,class:"used-badge"},_e={class:"invite-code-value"},je={class:"card-footer"},Ue={class:"invitation-rules"},ze={class:"rules-container"},Oe={class:"role-rules free-rules"},Pe={class:"role-rules-with-upgrade creator-rules"},Ve={class:"role-rules-content"},Se={class:"voucher-detail"},Te={class:"detail-section"},Ie={class:"detail-label"},Fe={class:"detail-value"},Be={class:"detail-section"},qe={class:"detail-label"},Je={class:"detail-value amount"},Ke={class:"currency"},We={class:"amount"},Ee={class:"detail-section"},He={class:"detail-label"},Ne={class:"detail-value status"},Qe={class:"detail-section"},Ge={class:"detail-label"},Xe={class:"detail-value"},Ye={class:"detail-section"},Ze={class:"detail-label"},es={class:"detail-value"},ss={class:"detail-section"},ts={class:"detail-label"},as={class:"detail-value"},ls={class:"detail-section"},is={class:"detail-label"},ns={class:"detail-value"},rs={class:"dialog-footer"},us=e({__name:"index",setup(e){new s;const us=n(),os=new R,{t:cs}=r(),ds=t(),vs=new x,ps=new l,ms=u({role:"2"==ds.user?.userRole?"creator":"free",avatar:ds.user?.avatarUrl,nickname:ds.user?.nickname,email:ds.user?.email||"",currentPoints:0,pointsList:[],inviteCodes:[],inviteCount:0,voucherCount:{availableCount:0,usedCount:0,expiredCount:0,totalCount:0},voucherList:[]}),Cs=u(null),hs=u(!1),ys=u(!1),$s=u(0);o(()=>{(async()=>{try{ys.value=!0;const e=await vs.getCodes();if(e.success){const s=e.data.map(e=>({code:e.inviteCode,used:1===e.isUsed,createdAt:e.createdAt,codeType:e.codeType}));ms.value.inviteCodes=s,ms.value.inviteCount=s.length}else j.error(e.message||"èŽ·å–é‚€è¯·ç å¤±è´¥")}catch(e){j.error("èŽ·å–é‚€è¯·ç å¤±è´¥")}finally{ys.value=!1}})(),(async()=>{const{data:e}=await os.getModelLimits();$s.value=e.total_score})(),(async()=>{try{ys.value=!0;const e=await vs.getVoucherList();e.success&&(ms.value.voucherList=e.data)}catch(e){j.error("èŽ·å–ä¼˜æƒ åˆ¸åˆ—è¡¨å¤±è´¥")}finally{ys.value=!1}})()});const fs=u(null),bs=()=>{fs.value?.click()},gs=async e=>{const s=e.target.files?.[0];if(s)if(s.type.startsWith("image/"))if(s.size>5242880)j.error("å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡5MB");else{try{const e=await ps.uploadFile(s),t=new FileReader;t.onload=e=>{ms.value.avatar=e.target.result},t.readAsDataURL(s);const a=await vs.updateProfile({avatarUrl:e,nickname:ms.value.nickname});a.success?(j.success("å¤´åƒæ›´æ–°æˆåŠŸ"),ds.user&&(ds.user.avatarUrl=e)):j.error(a.message||"å¤´åƒæ›´æ–°å¤±è´¥")}catch(t){j.error("å¤´åƒä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•")}e.target.value=""}else j.error("è¯·ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶")},ks=u(!1),ws=u(ms.value.nickname),xs=u(null),Rs=()=>{ks.value=!0,ws.value=ms.value.nickname,w(()=>{xs.value?.$el?.querySelector("input")?.focus()})},As=async()=>{if(ws.value.trim())try{const e=await vs.updateProfile({nickname:ws.value.trim(),avatarUrl:ms.value.avatar});e.success?(ms.value.nickname=ws.value.trim(),ds.user&&(ds.user.nickname=ws.value.trim()),j.success("æ˜µç§°æ›´æ–°æˆåŠŸ")):j.error(e.message||"æ˜µç§°æ›´æ–°å¤±è´¥")}catch(e){j.error("æ˜µç§°æ›´æ–°å¤±è´¥ï¼Œè¯·é‡è¯•")}else j.warning("æ˜µç§°ä¸èƒ½ä¸ºç©º");ks.value=!1};return(e,s)=>{const t=A,l=L,n=M,r=D,u=_;return d(),c("div",U,[v("div",z,[v("div",O,[v("div",P,[v("div",{class:"avatar-container",onClick:bs},[v("img",{src:ms.value.avatar,alt:"",class:"user-avatar"},null,8,V)])]),v("input",{ref_key:"avatarInput",ref:fs,type:"file",accept:"image/*",class:"avatar-input",onChange:gs,hidden:""},null,544)]),v("div",S,[v("div",T,[v("div",I,[v("h1",{onClick:Rs,class:C(["user-name",{editable:!0}])},h(ms.value.nickname),1),ks.value?(d(),c("div",F,[m(t,{modelValue:ws.value,"onUpdate:modelValue":s[0]||(s[0]=e=>ws.value=e),size:"large",onBlur:As,onKeyup:y(As,["enter"]),ref_key:"nameInput",ref:xs,placeholder:"Please enter a nickname"},null,8,["modelValue"])])):p("",!0)]),v("div",{class:C(["role-badge",ms.value.role])},h("creator"===ms.value.role?cs("roles.creator"):cs("roles.free")),3)]),v("div",B,h(ms.value.email),1)])]),v("div",q,[v("h2",null,h(e.$t("userCenter.points.title")),1),v("div",J,[v("div",K,[v("div",W,[s[5]||(s[5]=v("span",{class:"total-icon"},"ðŸª„",-1)),v("span",E,h(e.$t("userCenter.points.currentPoints")),1),v("span",H,h($s.value),1),m(l,{type:"primary",size:"default",class:"recharge-btn",onClick:s[1]||(s[1]=e=>b(us).push("/points-recharge"))},{default:$(()=>[f(h(e.$t("userCenter.points.recharge")),1)]),_:1})]),v("div",null,[v("div",N,[(d(!0),c(g,null,k(ms.value.pointsList,(t,a)=>(d(),c("div",{key:a,class:"points-item"},[v("div",Q,[s[6]||(s[6]=v("span",{class:"points-icon"},"ðŸª„",-1)),v("span",G,h(t.points),1)]),v("div",X,[v("span",Y,h(e.$t("userCenter.points.expiryDate"))+"ï¼š",1),v("span",Z,h(t.expiryDate),1)])]))),128))])])]),v("div",ee,[v("div",se,[v("table",te,[v("thead",null,[v("tr",null,[v("th",null,h(e.$t("userCenter.points.consumptionRules.behavior")),1),v("th",null,h(e.$t("userCenter.points.consumptionRules.pointsConsumption")),1)])]),v("tbody",null,[v("tr",null,[v("td",null,h(e.$t("userCenter.points.consumptionRules.rules.generateImage")),1),v("td",null,"1 "+h(e.$t("pointsRecharge.points")),1)]),v("tr",null,[v("td",null,h(e.$t("userCenter.points.consumptionRules.rules.generateModel")),1),v("td",null,"30 "+h(e.$t("pointsRecharge.points")),1)])])])]),v("div",ae,[v("ul",null,[v("li",null,h(e.$t("userCenter.points.consumptionRules.additionalRules.rule1")),1),v("li",null,h(e.$t("userCenter.points.consumptionRules.additionalRules.rule2")),1),v("li",null,h(e.$t("userCenter.points.consumptionRules.additionalRules.rule3")),1)])])])])]),ms.value.voucherList.length>0?(d(),c("div",le,[v("h2",null,h(e.$t("userCenter.voucher.title")),1),v("div",ie,[ys.value?(d(),c("div",ne,[m(n,{rows:3,animated:""})])):0===ms.value.voucherList.length?(d(),c("div",re,[m(r,{description:e.$t("userCenter.voucher.empty")},null,8,["description"])])):(d(),c("div",ue,[(d(!0),c(g,null,k(ms.value.voucherList,s=>(d(),c("div",{key:s.id,class:C(["voucher-card",["status-"+s.status]])},[v("div",oe,[v("div",ce,[v("span",de,h(s.currency),1),v("span",ve,h(s.amount),1)]),v("div",pe,h(s.statusDesc),1)]),v("div",me,[v("div",Ce,[v("div",he,h(s.couponCode),1),s.minOrderAmount>0?(d(),c("div",ye,h(e.$t("userCenter.voucher.minOrderAmount"))+": "+h(s.currency)+h(s.minOrderAmount),1)):p("",!0)]),v("div",$e,[v("span",fe,h(e.$t("userCenter.voucher.expireAt"))+":",1),v("span",be,h(new Date(s.expireAt).toLocaleDateString()),1)])])],2))),128))]))])])):p("",!0),ms.value.inviteCodes.filter(e=>"permanent"!=e.codeType).length>0&&!b(a).isDomesticDomain()?(d(),c("div",ge,[v("h2",null,h(e.$t("userCenter.invitation.title")),1),v("div",ke,[v("div",we,[v("label",null,h(e.$t("userCenter.invitation.inviteCount")),1),v("span",null,h(ms.value.inviteCount),1)])]),v("div",xe,[v("div",Re,[v("h3",null,h(e.$t("userCenter.invitation.inviteCodes")),1),m(l,{type:"primary",size:"default",class:"invite-details-btn",onClick:s[2]||(s[2]=e=>b(us).push("/user-center/invite-records"))},{default:$(()=>[f(h(e.$t("userCenter.invitation.inviteDetails")),1)]),_:1})]),v("div",Ae,[(d(!0),c(g,null,k(ms.value.inviteCodes.filter(e=>"permanent"!=e.codeType),(s,t)=>(d(),c("div",{key:t,class:C(["invite-card",{used:s.used}])},[v("div",Le,[v("span",Me,h(e.$t("userCenter.invitation.inviteCode")),1),s.used?(d(),c("span",De,h(e.$t("userCenter.invitation.used")),1)):p("",!0)]),v("div",_e,h(s.code),1),v("div",je,[m(l,{type:"primary",size:"small",onClick:e=>(e=>{const s=`${window.location.origin}/#/register?inviteCode=${e}`,t=cs("userCenter.invitation.inviteLinkMessage",{code:e,url:s});i(t,()=>{j.success(cs("userCenter.invitation.copySuccess"))},()=>{j.error(cs("userCenter.invitation.copyFailed"))})})(s.code),disabled:s.used,class:C(["copy-btn"])},{default:$(()=>[f(h(e.$t("userCenter.invitation.copyCode")),1)]),_:1},8,["onClick","disabled"])])],2))),128))])]),v("div",Ue,[v("h3",null,h(e.$t("userCenter.invitation.rules.title")),1),v("div",ze,[v("div",Oe,[v("h4",null,h(e.$t("userCenter.invitation.rules.freeMember.title")),1),v("ul",null,[v("li",null,h(e.$t("userCenter.invitation.rules.freeMember.reward")),1),v("ul",null,[v("li",null,h(e.$t("userCenter.invitation.rules.freeMember.pointsReward")),1)])])]),v("div",Pe,[v("div",Ve,[v("h4",null,h(e.$t("userCenter.invitation.rules.creatorMember.title")),1),v("p",null,h(e.$t("userCenter.invitation.rules.creatorMember.whenInvite")),1),v("ol",null,[v("li",null,h(e.$t("userCenter.invitation.rules.creatorMember.permission")),1),v("li",null,h(e.$t("userCenter.invitation.rules.creatorMember.commissionAbility")),1),v("li",null,h(e.$t("userCenter.invitation.rules.creatorMember.immediateReward")),1),v("li",null,h(e.$t("userCenter.invitation.rules.creatorMember.binding")),1),v("li",null,h(e.$t("userCenter.invitation.rules.creatorMember.subsequentOrder")),1),v("li",null,h(e.$t("userCenter.invitation.rules.creatorMember.commissionRate")),1)])])])])])])):p("",!0),m(u,{modelValue:hs.value,"onUpdate:modelValue":s[4]||(s[4]=e=>hs.value=e),title:e.$t("userCenter.voucher.detailTitle"),width:"600px"},{footer:$(()=>[v("span",rs,[m(l,{onClick:s[3]||(s[3]=e=>hs.value=!1)},{default:$(()=>[f(h(e.$t("userCenter.voucher.close")),1)]),_:1})])]),default:$(()=>[v("div",Se,[v("div",Te,[v("div",Ie,h(e.$t("userCenter.voucher.couponCode")),1),v("div",Fe,h(Cs.value.couponCode),1)]),v("div",Be,[v("div",qe,h(e.$t("userCenter.voucher.amount")),1),v("div",Je,[v("span",Ke,h(Cs.value.currency),1),v("span",We,h(Cs.value.amount),1)])]),v("div",Ee,[v("div",He,h(e.$t("userCenter.voucher.status")),1),v("div",Ne,h(Cs.value.statusDesc),1)]),v("div",Qe,[v("div",Ge,h(e.$t("userCenter.voucher.minOrderAmount")),1),v("div",Xe,h(Cs.value.currency)+h(Cs.value.minOrderAmount),1)]),v("div",Ye,[v("div",Ze,h(e.$t("userCenter.voucher.expireAt")),1),v("div",es,h(new Date(Cs.value.expireAt).toLocaleString()),1)]),v("div",ss,[v("div",ts,h(e.$t("userCenter.voucher.sourceDesc")),1),v("div",as,h(Cs.value.sourceDesc),1)]),v("div",ls,[v("div",is,h(e.$t("userCenter.voucher.createdAt")),1),v("div",ns,h(new Date(Cs.value.createdAt).toLocaleString()),1)])])]),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-23ea960c"]]);export{us as default};
