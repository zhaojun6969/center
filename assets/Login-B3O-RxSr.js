import{_ as a,u as e,c as l,r as o,i as s,T as i,L as t,e as n}from"./index-B89rLV4P.js";import{az as r,r as d,f as c,z as u,A as g,aJ as p,B as v,L as m,P as w,u as _,c as b,j as h,E as f,K as y,ai as k,R as x,J as C,aK as B,I as z,W as L,l as I,aA as j,aB as D}from"./vendor-Bn3bPSOS.js";import{D as S,E as A,F as E,G as F,H as G,I as q,J as H,K as M}from"./elementPlus-DTQfcfg-.js";import{u as O,m as J,r as K,e as P}from"./index-CkXVwDvV.js";import{L as T}from"./login-CPlhOrd3.js";const U=["disabled"],V={class:"button-text"},$={key:0},R={key:1},W={key:0,class:"loading-spinner"},N=a({__name:"GoogleOAuthButton",props:{loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},code:{type:String,default:""}},emits:["success","error"],setup(a,{emit:l}){const i=e(),{t:t}=r(),n=l,b=a,h=d(!1),f=()=>new Promise((a,e)=>{if(window.google&&window.google.accounts&&window.google.accounts.id)return a();const l=document.createElement("script");l.src="https://accounts.google.com/gsi/client",l.async=!0,l.defer=!0,l.onload=()=>a(),l.onerror=a=>e(new Error("Google Identity Services 脚本加载失败")),document.head.appendChild(l)}),y=async()=>{if(h.value)return;h.value=!0,await f();window.google.accounts.id.initialize({client_id:"1087356879940-kcdvstc2pgoim27gffl67qrs297avdmb.apps.googleusercontent.com",callback:async a=>{const e=a&&a.credential;e?await k(e):errorMessage.value="未获取到 Google 身份凭证"}}),window.google.accounts.id.prompt()},k=async a=>{try{const e=await o.common(s.OAUTH_GOOGLE,{googleIdToken:a,inviteCode:b.code});let l=e.data;return void i.loginSuccess(l,()=>{n("success",e.data.user)})}catch(e){throw n("error",e),e}finally{h.value=!1}};return c(()=>{f()}),(e,l)=>(g(),u("button",{class:"google-oauth-button",disabled:a.loading||a.disabled,onClick:y},[l[0]||(l[0]=p('<div class="google-logo" data-v-c8832a21><svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg" data-v-c8832a21><path fill="#4285F4" d="M16.51 8.44c0-.62-.05-1.22-.15-1.8H8.98v3.4h4.05c-.17 1-.75 1.85-1.6 2.42v2.01h2.59c1.52-1.4 2.39-3.46 2.39-5.89z" data-v-c8832a21></path><path fill="#34A853" d="M8.98 17.5c2.43 0 4.47-.8 5.96-2.17l-2.59-2.01c-.8.54-1.83.86-2.99.86-2.3 0-4.24-1.55-4.93-3.64H2.18v2.07C3.99 15.95 6.26 17.5 8.98 17.5z" data-v-c8832a21></path><path fill="#FBBC05" d="M4.05 10.91c-.15-.54-.23-1.12-.23-1.91s.08-1.37.23-1.91V4.94H2.18C1.55 6.16 1.2 7.55 1.2 9s.35 2.84.98 4.06l2.87-2.15z" data-v-c8832a21></path><path fill="#EA4335" d="M8.98 4.18c1.17 0 2.22.4 3.06 1.18l2.3-2.3C13.46 1.8 11.41 1.2 8.98 1.2 6.26 1.2 3.99 2.75 2.18 4.94l2.87 2.15c.69-2.09 2.63-3.64 4.93-3.64z" data-v-c8832a21></path></svg></div>',1)),v("span",V,[a.loading?(g(),u("span",R,w(_(t)("login.google_logging")),1)):(g(),u("span",$,w(_(t)("login.google_login")),1))]),a.loading?(g(),u("div",W)):m("",!0)],8,U))}},[["__scopeId","data-v-c8832a21"]]),Q={class:"form-group"},X={class:"form-label",for:"email"},Y=["placeholder","disabled"],Z={key:0,class:"input-error-icon"},aa={key:0,class:"error-message"},ea={class:"form-group"},la={class:"form-label",for:"password"},oa=["type","placeholder","disabled"],sa=["disabled"],ia={key:0,class:"error-message"},ta=["disabled"],na={class:"button-text"},ra={key:0},da={key:1},ca={key:0,class:"loading-spinner"},ua={style:{"text-align":"center","font-size":"14px",cursor:"pointer"}},ga=["disabled"],pa=a({__name:"LoginForm",props:{loading:{type:Boolean,default:!1}},emits:["login","error"],setup(a,{emit:e}){const{t:l}=r(),o=e,s=d({email:"",password:""}),i=d(!1),t=d(!1),n=d(!1),c=d(""),p=d(""),I={email:{required:K,email:P},password:{required:K,minLength:J(6)}},j=O(I,s),D=b(()=>s.value.email&&s.value.password&&!c.value&&!p.value),G=()=>{s.value.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.value.email)?c.value="":c.value=l("login.email_invalid_error"):c.value=l("login.email_empty_error")},q=()=>{s.value.password?s.value.password.length<6?p.value=l("login.password_min_error"):p.value="":p.value=l("login.password_empty_error")};h(()=>s.value.email,G),h(()=>s.value.password,q);const H=async()=>{if(await j.value.$validate(),j.value.$invalid)return G(),void q();o("login",s.value)};return(e,o)=>{const r=A;return g(),u("form",{class:"login-form",onSubmit:L(H,["prevent"])},[v("div",Q,[v("label",X,w(_(l)("login.email_label")),1),v("div",{class:f(["input-wrapper",{focused:i.value}])},[y(v("input",{id:"email","onUpdate:modelValue":o[0]||(o[0]=a=>s.value.email=a),type:"email",class:f(["form-input",{error:c.value}]),placeholder:_(l)("login.email_placeholder"),onFocus:o[1]||(o[1]=a=>i.value=!0),onBlur:o[2]||(o[2]=a=>i.value=!1),disabled:a.loading,autocomplete:"email"},null,42,Y),[[k,s.value.email]]),c.value?(g(),u("div",Z,[x(r,null,{default:C(()=>[x(_(S))]),_:1})])):m("",!0)],2),c.value?(g(),u("div",aa,w(c.value),1)):m("",!0)]),v("div",ea,[v("label",la,w(_(l)("login.password_label")),1),v("div",{class:f(["input-wrapper",{focused:t.value}])},[y(v("input",{id:"password","onUpdate:modelValue":o[3]||(o[3]=a=>s.value.password=a),type:n.value?"text":"password",class:f(["form-input",{error:p.value}]),placeholder:_(l)("login.password_placeholder"),onFocus:o[4]||(o[4]=a=>t.value=!0),onBlur:o[5]||(o[5]=a=>t.value=!1),disabled:a.loading,autocomplete:"current-password"},null,42,oa),[[B,s.value.password]]),v("button",{type:"button",class:"password-toggle",onClick:o[6]||(o[6]=a=>n.value=!n.value),disabled:a.loading},[n.value?(g(),z(r,{key:0},{default:C(()=>[x(_(E))]),_:1})):(g(),z(r,{key:1},{default:C(()=>[x(_(F))]),_:1}))],8,sa)],2),p.value?(g(),u("div",ia,w(p.value),1)):m("",!0)]),v("button",{type:"submit",class:"login-submit-button",disabled:a.loading||!D.value},[v("span",na,[a.loading?(g(),u("span",da,w(_(l)("login.email_logging")),1)):(g(),u("span",ra,w(_(l)("login.email_login")),1))]),a.loading?(g(),u("div",ca)):m("",!0)],8,ta),v("div",ua,[v("button",{type:"submit",class:"waitlist-button",disabled:a.loading||!D.value},w(_(l)("login.join_waitlist")),9,ga)]),m("",!0)],32)}}},[["__scopeId","data-v-a4c8d729"]]),va={class:"login-page"},ma={class:"top-right-controls"},wa={class:"controls-container"},_a=["title"],ba={class:"login-container"},ha={class:"login-card"},fa={key:0,class:"google-login-section"},ya={key:1,class:"divider"},ka={class:"divider-text"},xa={class:"email-login-section"},Ca={key:2,class:"error-message"},Ba={class:"auth-links"},za={class:"auth-links-row"},La=a({__name:"Login",setup(a){const l=j(),o=e(),{t:s}=r(),p=I(new T);d(null),d(!0);const b=async a=>{p.login(a)},h=a=>{p.handleLoginSuccess(a)},f=D(),y=()=>{l.push("/")},k=()=>{l.push("/forgot-password")},B=()=>{l.push({name:"register",query:f.query})},z=()=>{l.replace("/login/phone")};return c(()=>{window.localStorage.getItem("token")&&l.replace("/czhome")}),(a,e)=>{const l=A;return g(),u("div",va,[e[2]||(e[2]=v("div",{class:"login-background"},null,-1)),v("div",ma,[v("div",wa,[v("button",{type:"button",class:"back-home-btn",onClick:y,title:_(s)("login.back_to_home")},[x(l,{class:"back-home-icon"},{default:C(()=>[x(_(G))]),_:1})],8,_a),x(i,{position:"top-right","tooltip-text":_(s)("login.theme_toggle_tooltip")},null,8,["tooltip-text"]),x(t,{position:"top-right","tooltip-text":_(s)("login.language_toggle_tooltip")},null,8,["tooltip-text"])])]),v("div",ba,[v("div",ha,[_(n).isDomesticDomain()?m("",!0):(g(),u("div",fa,[x(N,{onSuccess:h,disabled:!1})])),_(n).isDomesticDomain()?m("",!0):(g(),u("div",ya,[e[0]||(e[0]=v("div",{class:"divider-line"},null,-1)),v("span",ka,w(_(s)("login.divider_text")),1),e[1]||(e[1]=v("div",{class:"divider-line"},null,-1))])),v("div",xa,[x(pa,{onLogin:b})]),_(o).error?(g(),u("div",Ca,[x(l,{class:"error-icon"},{default:C(()=>[x(_(S))]),_:1}),v("span",null,w(_(o).error),1)])):m("",!0),v("div",Ba,[v("div",za,[_(n).isDomesticDomain()?(g(),u("button",{key:0,type:"button",class:"auth-link phone-login-link",onClick:z},[x(l,{class:"link-icon"},{default:C(()=>[x(_(q))]),_:1}),v("span",null,w(_(s)("login.phone_login_link")),1)])):m("",!0),v("button",{type:"button",class:"auth-link forgot-password-link",onClick:k},[x(l,{class:"link-icon"},{default:C(()=>[x(_(H))]),_:1}),v("span",null,w(_(s)("login.forgot_password")),1)]),v("button",{type:"button",class:"auth-link register-link",onClick:B},[x(l,{class:"link-icon"},{default:C(()=>[x(_(M))]),_:1}),v("span",null,w(_(s)("login.register_account")),1)])])])])])])}}},[["__scopeId","data-v-0091a67f"]]);export{La as default};
