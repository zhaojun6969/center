import{_ as e,W as t,u as s,e as a,F as i}from"./index-BXg9AdUO.js";/* empty css                   *//* empty css                 *//* empty css                    *//* empty css                         *//* empty css                 */import{aA as l,az as n,r,f as o,z as u,A as c,B as d,L as v,R as p,E as m,P as C,ah as h,J as y,O as f,u as b,Q as $,a5 as g,n as k}from"./vendor-Bn3bPSOS.js";import{U as w}from"./index-Ceb-tsmh.js";import{M as x}from"./index-Cm_xOBW7.js";import{z as R,t as A,a8 as M,a9 as L,v as D,w as _}from"./elementPlus-DTQfcfg-.js";const j={class:"user-center-container"},U={class:"user-info-section"},z={class:"user-avatar-section"},P={class:"avatar-wrapper"},V=["src"],O={class:"user-details-section"},S={class:"user-name-row"},T={class:"editable-name-container"},F={key:0,class:"name-edit-form"},I={class:"user-email"},B={class:"points-section"},q={class:"points-content-container"},E={class:"points-list"},J={class:"total-points"},W={class:"total-label"},K={class:"points-value"},N={class:"points-items"},Q={class:"points-item-left"},G={class:"points-number"},H={class:"points-item-right"},X={class:"expiry-label"},Y={class:"expiry-date"},Z={class:"points-consumption-rules"},ee={class:"rules-table-container"},te={class:"points-rules-table"},se={class:"additional-rules"},ae={key:0,class:"voucher-section"},ie={class:"voucher-list-container"},le={key:0,class:"loading-container"},ne={key:1,class:"empty-vouchers"},re={key:2,class:"voucher-grid"},oe={class:"voucher-header"},ue={class:"voucher-amount"},ce={class:"currency"},de={class:"amount"},ve={class:"voucher-status"},pe={class:"voucher-body"},me={class:"voucher-info"},Ce={class:"voucher-code"},he={key:0,class:"voucher-min-order"},ye={class:"voucher-expiry"},fe={class:"expiry-label"},be={class:"expiry-date"},$e={key:1,class:"invitation-section"},ge={class:"invitation-info"},ke={class:"info-item"},we={class:"invite-codes-section"},xe={class:"section-header"},Re={class:"invite-cards-container"},Ae={class:"card-header"},Me={class:"card-title"},Le={key:0,class:"used-badge"},De={class:"invite-code-value"},_e={class:"card-footer"},je={class:"invitation-rules"},Ue={class:"rules-container"},ze={class:"role-rules free-rules"},Pe={class:"role-rules-with-upgrade creator-rules"},Ve={class:"role-rules-content"},Oe={class:"voucher-detail"},Se={class:"detail-section"},Te={class:"detail-label"},Fe={class:"detail-value"},Ie={class:"detail-section"},Be={class:"detail-label"},qe={class:"detail-value amount"},Ee={class:"currency"},Je={class:"amount"},We={class:"detail-section"},Ke={class:"detail-label"},Ne={class:"detail-value status"},Qe={class:"detail-section"},Ge={class:"detail-label"},He={class:"detail-value"},Xe={class:"detail-section"},Ye={class:"detail-label"},Ze={class:"detail-value"},et={class:"detail-section"},tt={class:"detail-label"},st={class:"detail-value"},at={class:"detail-section"},it={class:"detail-label"},lt={class:"detail-value"},nt={class:"dialog-footer"},rt=e({__name:"index",setup(e){new t;const rt=l(),ot=new x,{t:ut}=n(),ct=s(),dt=new w,vt=new i,pt=r({role:"2"==ct.user?.userRole?"creator":"free",avatar:ct.user?.avatarUrl,nickname:ct.user?.nickname,email:ct.user?.email||"",currentPoints:0,pointsList:[],inviteCodes:[],inviteCount:0,voucherCount:{availableCount:0,usedCount:0,expiredCount:0,totalCount:0},voucherList:[]}),mt=r(null),Ct=r(!1),ht=r(!1),yt=r(0);o(()=>{(async()=>{try{ht.value=!0;const e=await dt.getCodes();if(e.success){const t=e.data.map(e=>({code:e.inviteCode,used:1===e.isUsed,createdAt:e.createdAt,codeType:e.codeType}));pt.value.inviteCodes=t,pt.value.inviteCount=t.length}else _.error(e.message||"èŽ·å–é‚€è¯·ç å¤±è´¥")}catch(e){_.error("èŽ·å–é‚€è¯·ç å¤±è´¥")}finally{ht.value=!1}})(),(async()=>{const{data:e}=await ot.getModelLimits();yt.value=e.total_score})(),(async()=>{try{ht.value=!0;const e=await dt.getVoucherList();e.success&&(pt.value.voucherList=e.data)}catch(e){_.error("èŽ·å–ä¼˜æƒ åˆ¸åˆ—è¡¨å¤±è´¥")}finally{ht.value=!1}})()});const ft=r(null),bt=()=>{ft.value?.click()},$t=async e=>{const t=e.target.files?.[0];if(t)if(t.type.startsWith("image/"))if(t.size>5242880)_.error("å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡5MB");else{try{const e=await vt.uploadFile(t),s=new FileReader;s.onload=e=>{pt.value.avatar=e.target.result},s.readAsDataURL(t);const a=await dt.updateProfile({avatarUrl:e,nickname:pt.value.nickname});a.success?(_.success("å¤´åƒæ›´æ–°æˆåŠŸ"),ct.user&&(ct.user.avatarUrl=e)):_.error(a.message||"å¤´åƒæ›´æ–°å¤±è´¥")}catch(s){_.error("å¤´åƒä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•")}e.target.value=""}else _.error("è¯·ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶")},gt=r(!1),kt=r(pt.value.nickname),wt=r(null),xt=()=>{gt.value=!0,kt.value=pt.value.nickname,k(()=>{wt.value?.$el?.querySelector("input")?.focus()})},Rt=async()=>{if(kt.value.trim())try{const e=await dt.updateProfile({nickname:kt.value.trim(),avatarUrl:pt.value.avatar});e.success?(pt.value.nickname=kt.value.trim(),ct.user&&(ct.user.nickname=kt.value.trim()),_.success("æ˜µç§°æ›´æ–°æˆåŠŸ")):_.error(e.message||"æ˜µç§°æ›´æ–°å¤±è´¥")}catch(e){_.error("æ˜µç§°æ›´æ–°å¤±è´¥ï¼Œè¯·é‡è¯•")}else _.warning("æ˜µç§°ä¸èƒ½ä¸ºç©º");gt.value=!1};return(e,t)=>{const s=R,i=A,l=M,n=L,r=D;return c(),u("div",j,[d("div",U,[d("div",z,[d("div",P,[d("div",{class:"avatar-container",onClick:bt},[d("img",{src:pt.value.avatar,alt:"",class:"user-avatar"},null,8,V)])]),d("input",{ref_key:"avatarInput",ref:ft,type:"file",accept:"image/*",class:"avatar-input",onChange:$t,hidden:""},null,544)]),d("div",O,[d("div",S,[d("div",T,[d("h1",{onClick:xt,class:m(["user-name",{editable:!0}])},C(pt.value.nickname),1),gt.value?(c(),u("div",F,[p(s,{modelValue:kt.value,"onUpdate:modelValue":t[0]||(t[0]=e=>kt.value=e),size:"large",onBlur:Rt,onKeyup:h(Rt,["enter"]),ref_key:"nameInput",ref:wt,placeholder:"Please enter a nickname"},null,8,["modelValue"])])):v("",!0)]),d("div",{class:m(["role-badge",pt.value.role])},C("creator"===pt.value.role?ut("roles.creator"):ut("roles.free")),3)]),d("div",I,C(pt.value.email),1)])]),d("div",B,[d("h2",null,C(e.$t("userCenter.points.title")),1),d("div",q,[d("div",E,[d("div",J,[t[5]||(t[5]=d("span",{class:"total-icon"},"ðŸª„",-1)),d("span",W,C(e.$t("userCenter.points.currentPoints")),1),d("span",K,C(yt.value),1),p(i,{type:"primary",size:"default",class:"recharge-btn",onClick:t[1]||(t[1]=e=>b(rt).push("/points-recharge"))},{default:y(()=>[f(C(e.$t("userCenter.points.recharge")),1)]),_:1})]),d("div",null,[d("div",N,[(c(!0),u($,null,g(pt.value.pointsList,(s,a)=>(c(),u("div",{key:a,class:"points-item"},[d("div",Q,[t[6]||(t[6]=d("span",{class:"points-icon"},"ðŸª„",-1)),d("span",G,C(s.points),1)]),d("div",H,[d("span",X,C(e.$t("userCenter.points.expiryDate"))+"ï¼š",1),d("span",Y,C(s.expiryDate),1)])]))),128))])])]),d("div",Z,[d("div",ee,[d("table",te,[d("thead",null,[d("tr",null,[d("th",null,C(e.$t("userCenter.points.consumptionRules.behavior")),1),d("th",null,C(e.$t("userCenter.points.consumptionRules.pointsConsumption")),1)])]),d("tbody",null,[d("tr",null,[d("td",null,C(e.$t("userCenter.points.consumptionRules.rules.generateImage")),1),d("td",null,"1 "+C(e.$t("pointsRecharge.points")),1)]),d("tr",null,[d("td",null,C(e.$t("userCenter.points.consumptionRules.rules.generateModel")),1),d("td",null,"30 "+C(e.$t("pointsRecharge.points")),1)])])])]),d("div",se,[d("ul",null,[d("li",null,C(e.$t("userCenter.points.consumptionRules.additionalRules.rule1")),1),d("li",null,C(e.$t("userCenter.points.consumptionRules.additionalRules.rule2")),1),d("li",null,C(e.$t("userCenter.points.consumptionRules.additionalRules.rule3")),1)])])])])]),pt.value.voucherList.length>0?(c(),u("div",ae,[d("h2",null,C(e.$t("userCenter.voucher.title")),1),d("div",ie,[ht.value?(c(),u("div",le,[p(l,{rows:3,animated:""})])):0===pt.value.voucherList.length?(c(),u("div",ne,[p(n,{description:e.$t("userCenter.voucher.empty")},null,8,["description"])])):(c(),u("div",re,[(c(!0),u($,null,g(pt.value.voucherList,t=>(c(),u("div",{key:t.id,class:m(["voucher-card",["status-"+t.status]])},[d("div",oe,[d("div",ue,[d("span",ce,C(t.currency),1),d("span",de,C(t.amount),1)]),d("div",ve,C(t.statusDesc),1)]),d("div",pe,[d("div",me,[d("div",Ce,C(t.couponCode),1),t.minOrderAmount>0?(c(),u("div",he,C(e.$t("userCenter.voucher.minOrderAmount"))+": "+C(t.currency)+C(t.minOrderAmount),1)):v("",!0)]),d("div",ye,[d("span",fe,C(e.$t("userCenter.voucher.expireAt"))+":",1),d("span",be,C(new Date(t.expireAt).toLocaleDateString()),1)])])],2))),128))]))])])):v("",!0),pt.value.inviteCodes.filter(e=>"permanent"!=e.codeType).length>0&&!b(a).isDomesticDomain()?(c(),u("div",$e,[d("h2",null,C(e.$t("userCenter.invitation.title")),1),d("div",ge,[d("div",ke,[d("label",null,C(e.$t("userCenter.invitation.inviteCount")),1),d("span",null,C(pt.value.inviteCount),1)])]),d("div",we,[d("div",xe,[d("h3",null,C(e.$t("userCenter.invitation.inviteCodes")),1),p(i,{type:"primary",size:"default",class:"invite-details-btn",onClick:t[2]||(t[2]=e=>b(rt).push("/user-center/invite-records"))},{default:y(()=>[f(C(e.$t("userCenter.invitation.inviteDetails")),1)]),_:1})]),d("div",Re,[(c(!0),u($,null,g(pt.value.inviteCodes.filter(e=>"permanent"!=e.codeType),(t,s)=>(c(),u("div",{key:s,class:m(["invite-card",{used:t.used}])},[d("div",Ae,[d("span",Me,C(e.$t("userCenter.invitation.inviteCode")),1),t.used?(c(),u("span",Le,C(e.$t("userCenter.invitation.used")),1)):v("",!0)]),d("div",De,C(t.code),1),d("div",_e,[p(i,{type:"primary",size:"small",onClick:e=>(e=>{const t=`${window.location.origin}/#/register?inviteCode=${e}`,s=ut("userCenter.invitation.inviteLinkMessage",{code:e,url:t}),a=e=>{const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",t.style.top="-999999px",document.body.appendChild(t),t.focus(),t.select();try{const e=document.execCommand("copy");return document.body.removeChild(t),e}catch(s){return document.body.removeChild(t),!1}};navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(s).then(()=>{_.success(ut("userCenter.invitation.copySuccess"))}).catch(()=>{a(s)?_.success(ut("userCenter.invitation.copySuccess")):_.error(ut("userCenter.invitation.copyFailed"))}):a(s)?_.success(ut("userCenter.invitation.copySuccess")):_.error(ut("userCenter.invitation.copyFailed"))})(t.code),disabled:t.used,class:m(["copy-btn"])},{default:y(()=>[f(C(e.$t("userCenter.invitation.copyCode")),1)]),_:1},8,["onClick","disabled"])])],2))),128))])]),d("div",je,[d("h3",null,C(e.$t("userCenter.invitation.rules.title")),1),d("div",Ue,[d("div",ze,[d("h4",null,C(e.$t("userCenter.invitation.rules.freeMember.title")),1),d("ul",null,[d("li",null,C(e.$t("userCenter.invitation.rules.freeMember.reward")),1),d("ul",null,[d("li",null,C(e.$t("userCenter.invitation.rules.freeMember.pointsReward")),1)])])]),d("div",Pe,[d("div",Ve,[d("h4",null,C(e.$t("userCenter.invitation.rules.creatorMember.title")),1),d("p",null,C(e.$t("userCenter.invitation.rules.creatorMember.whenInvite")),1),d("ol",null,[d("li",null,C(e.$t("userCenter.invitation.rules.creatorMember.permission")),1),d("li",null,C(e.$t("userCenter.invitation.rules.creatorMember.commissionAbility")),1),d("li",null,C(e.$t("userCenter.invitation.rules.creatorMember.immediateReward")),1),d("li",null,C(e.$t("userCenter.invitation.rules.creatorMember.binding")),1),d("li",null,C(e.$t("userCenter.invitation.rules.creatorMember.subsequentOrder")),1),d("li",null,C(e.$t("userCenter.invitation.rules.creatorMember.commissionRate")),1)])])])])])])):v("",!0),p(r,{modelValue:Ct.value,"onUpdate:modelValue":t[4]||(t[4]=e=>Ct.value=e),title:e.$t("userCenter.voucher.detailTitle"),width:"600px"},{footer:y(()=>[d("span",nt,[p(i,{onClick:t[3]||(t[3]=e=>Ct.value=!1)},{default:y(()=>[f(C(e.$t("userCenter.voucher.close")),1)]),_:1})])]),default:y(()=>[d("div",Oe,[d("div",Se,[d("div",Te,C(e.$t("userCenter.voucher.couponCode")),1),d("div",Fe,C(mt.value.couponCode),1)]),d("div",Ie,[d("div",Be,C(e.$t("userCenter.voucher.amount")),1),d("div",qe,[d("span",Ee,C(mt.value.currency),1),d("span",Je,C(mt.value.amount),1)])]),d("div",We,[d("div",Ke,C(e.$t("userCenter.voucher.status")),1),d("div",Ne,C(mt.value.statusDesc),1)]),d("div",Qe,[d("div",Ge,C(e.$t("userCenter.voucher.minOrderAmount")),1),d("div",He,C(mt.value.currency)+C(mt.value.minOrderAmount),1)]),d("div",Xe,[d("div",Ye,C(e.$t("userCenter.voucher.expireAt")),1),d("div",Ze,C(new Date(mt.value.expireAt).toLocaleString()),1)]),d("div",et,[d("div",tt,C(e.$t("userCenter.voucher.sourceDesc")),1),d("div",st,C(mt.value.sourceDesc),1)]),d("div",at,[d("div",it,C(e.$t("userCenter.voucher.createdAt")),1),d("div",lt,C(new Date(mt.value.createdAt).toLocaleString()),1)])])]),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-bbf1e836"]]);export{rt as default};
