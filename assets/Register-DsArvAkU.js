import{_ as e,u as a,T as l,L as s}from"./index-B89rLV4P.js";import{az as r,r as i,j as o,z as t,A as d,B as u,L as n,P as v,u as c,E as p,K as m,ai as g,R as f,J as _,X as b,c as y,aK as C,I as w,W as k,f as h,aB as V,aA as x,O as I}from"./vendor-Bn3bPSOS.js";import{D as B,E as j,F,G as q,w as S,L as U}from"./elementPlus-DTQfcfg-.js";import{L as A}from"./login-CPlhOrd3.js";/* empty css                   */const E={class:"invite-code-section"},L={class:"form-group"},R={class:"form-label",for:"inviteCode"},z=["placeholder","disabled"],D={key:0,class:"input-error-icon"},K={key:0,class:"error-message"},P=e({__name:"InviteCodeInput",props:{modelValue:{type:String,default:""},error:{type:String,default:""},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","validate"],setup(e,{emit:a}){const l=e,s=a,{t:b}=r(),y=i(!1),C=i(l.modelValue);return o(()=>l.modelValue,e=>{C.value=e}),o(C,e=>{s("update:modelValue",e),s("validate",e)}),(a,l)=>{const s=j;return d(),t("div",E,[u("div",L,[u("label",R,v(c(b)("login.invite_code_label")),1),u("div",{class:p(["input-wrapper",{focused:y.value}])},[m(u("input",{id:"inviteCode","onUpdate:modelValue":l[0]||(l[0]=e=>C.value=e),type:"text",class:p(["form-input",{error:e.error}]),placeholder:c(b)("login.invite_code_placeholder"),onFocus:l[1]||(l[1]=e=>y.value=!0),onBlur:l[2]||(l[2]=e=>y.value=!1),disabled:e.disabled,autocomplete:"off"},null,42,z),[[g,C.value]]),e.error?(d(),t("div",D,[f(s,null,{default:_(()=>[f(c(B))]),_:1})])):n("",!0)],2),e.error?(d(),t("div",K,v(e.error),1)):n("",!0)])])}}},[["__scopeId","data-v-f196bc10"]]),$={class:"form-group"},G={class:"form-label",for:"email"},J=["placeholder","disabled"],O={key:0,class:"input-error-icon"},T={key:0,class:"error-message"},W={class:"form-group"},X={class:"form-label",for:"verificationCode"},H={class:"verification-wrapper"},M=["placeholder","disabled"],N={key:0,class:"input-error-icon"},Q=["disabled"],Y={key:0},Z={key:1},ee={key:2},ae={key:0,class:"error-message"},le={class:"form-group"},se={class:"form-label",for:"password"},re=["type","placeholder","disabled"],ie=["disabled"],oe={key:0,class:"error-message"},te={class:"form-group"},de={key:0,class:"error-message"},ue=["disabled"],ne={class:"button-text"},ve={key:0},ce={key:1},pe={key:0,class:"loading-spinner"},me=e({__name:"RegisterForm",props:{loading:{type:Boolean,default:!1},inviteCode:{type:String,default:""}},emits:["success","error"],setup(e,{emit:a}){const{t:l}=r(),s=new A,h=a,V=e,x=i({email:"",password:"",verificationCode:"",inviteCode:""}),I=i(!1),U=i(!1),E=i(!1),L=i(!1),R=i(!1),z=i(0);let D=null;b(()=>{D&&(clearInterval(D),D=null)});const K=i(""),me=i(""),ge=i(""),fe=i(""),_e=y(()=>x.value.email&&x.value.password&&x.value.verificationCode&&x.value.inviteCode&&!K.value&&!me.value&&!ge.value&&!fe.value),be=y(()=>x.value.email&&!K.value),ye=async()=>{if(be.value&&!R.value){R.value=!0;try{s.sendEmailCode({email:x.value.email,purpose:"register"},()=>{z.value=60,D=setInterval(()=>{z.value>0?z.value--:(clearInterval(D),D=null)},1e3)})}catch(e){S.error(l("register.verification_code_send_failed"))}finally{R.value=!1}}},Ce=()=>{x.value.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(x.value.email)?K.value="":K.value=l("register.email_invalid_error"):K.value=l("register.email_empty_error")},we=()=>{x.value.password?x.value.password.length<6?me.value=l("register.password_min_error"):me.value="":me.value=l("register.password_empty_error")},ke=()=>{x.value.verificationCode?/^\d{6}$/.test(x.value.verificationCode)?ge.value="":ge.value=l("register.verification_code_invalid_error"):ge.value=l("register.verification_code_empty_error")},he=()=>{x.value.inviteCode?fe.value="":fe.value=l("register.invite_code_empty_error")};o(()=>x.value.email,Ce),o(()=>x.value.password,we),o(()=>x.value.verificationCode,ke),o(()=>x.value.inviteCode,he),o(()=>V.inviteCode,e=>{e&&(x.value.inviteCode=e)},{immediate:!0});const Ve=()=>{x.value.email&&x.value.password&&x.value.verificationCode&&x.value.inviteCode&&s.confirmRegister({email:x.value.email,emailCode:x.value.verificationCode,password:x.value.password,inviteCode:x.value.inviteCode},()=>{h("success")})};return(a,s)=>{const r=j;return d(),t("form",{class:"register-form",onSubmit:k(Ve,["prevent"])},[u("div",$,[u("label",G,v(c(l)("register.email_label")),1),u("div",{class:p(["input-wrapper",{focused:I.value}])},[m(u("input",{id:"email","onUpdate:modelValue":s[0]||(s[0]=e=>x.value.email=e),type:"email",class:p(["form-input",{error:K.value}]),placeholder:c(l)("register.email_placeholder"),onFocus:s[1]||(s[1]=e=>I.value=!0),onBlur:Ce,disabled:e.loading,autocomplete:"email"},null,42,J),[[g,x.value.email]]),K.value?(d(),t("div",O,[f(r,null,{default:_(()=>[f(c(B))]),_:1})])):n("",!0)],2),K.value?(d(),t("div",T,v(K.value),1)):n("",!0)]),u("div",W,[u("label",X,v(c(l)("register.verification_code_label")),1),u("div",H,[u("div",{class:p(["input-wrapper",{focused:E.value}])},[m(u("input",{id:"verificationCode","onUpdate:modelValue":s[2]||(s[2]=e=>x.value.verificationCode=e),type:"text",class:p(["form-input verification-input",{error:ge.value}]),placeholder:c(l)("register.verification_code_placeholder"),onFocus:s[3]||(s[3]=e=>E.value=!0),onBlur:ke,disabled:e.loading,maxlength:"6",autocomplete:"off"},null,42,M),[[g,x.value.verificationCode]]),ge.value?(d(),t("div",N,[f(r,null,{default:_(()=>[f(c(B))]),_:1})])):n("",!0)],2),u("button",{type:"button",class:p(["send-code-button",{"countdown-active":z.value>0}]),onClick:ye,disabled:R.value||z.value>0},[z.value>0?(d(),t("span",Y,v(z.value)+"s",1)):R.value?(d(),t("span",Z,v(c(l)("register.sending_code")),1)):(d(),t("span",ee,v(c(l)("register.send_code")),1))],10,Q)]),ge.value?(d(),t("div",ae,v(ge.value),1)):n("",!0)]),u("div",le,[u("label",se,v(c(l)("register.password_label")),1),u("div",{class:p(["input-wrapper",{focused:U.value}])},[m(u("input",{id:"password","onUpdate:modelValue":s[4]||(s[4]=e=>x.value.password=e),type:L.value?"text":"password",class:p(["form-input",{error:me.value}]),placeholder:c(l)("register.password_placeholder"),onFocus:s[5]||(s[5]=e=>U.value=!0),onBlur:we,disabled:e.loading,autocomplete:"new-password"},null,42,re),[[C,x.value.password]]),u("button",{type:"button",class:"password-toggle",onClick:s[6]||(s[6]=e=>L.value=!L.value),disabled:e.loading},[L.value?(d(),w(r,{key:0},{default:_(()=>[f(c(F))]),_:1})):(d(),w(r,{key:1},{default:_(()=>[f(c(q))]),_:1}))],8,ie)],2),me.value?(d(),t("div",oe,v(me.value),1)):n("",!0)]),u("div",te,[f(P,{modelValue:x.value.inviteCode,"onUpdate:modelValue":s[7]||(s[7]=e=>x.value.inviteCode=e),error:fe.value,disabled:e.loading,onValidate:he},null,8,["modelValue","error","disabled"]),fe.value?(d(),t("div",de,v(fe.value),1)):n("",!0)]),u("button",{type:"submit",class:"register-submit-button",disabled:e.loading||!_e.value},[u("span",ne,[e.loading?(d(),t("span",ce,v(c(l)("register.registering")),1)):(d(),t("span",ve,v(c(l)("register.register_button")),1))]),e.loading?(d(),t("div",pe)):n("",!0)],8,ue)],32)}}},[["__scopeId","data-v-3a413560"]]),ge={class:"register-page"},fe={class:"top-right-controls"},_e={class:"controls-container"},be={class:"register-container"},ye={class:"register-card"},Ce={class:"back-to-login"},we={class:"register-header"},ke={class:"register-title"},he={class:"register-subtitle"},Ve={class:"register-form-section"},xe={class:"login-prompt"},Ie={class:"prompt-text"},Be={key:0,class:"error-message"},je=e({__name:"Register",setup(e){const o=x(),p=V(),m=a(),{t:g}=r(),b=i("");h(()=>{const e=p.query.inviteCode;e&&(b.value=e)});const y=e=>{const a=p.query;o.replace({name:"login",query:a})},C=e=>{},w=()=>{const e=p.query;o.replace({name:"login",query:e})};return h(()=>{m.isAuthenticated&&(m.isCreator?o.push("/creator"):m.isAdmin?o.push("/admin"):o.push("/dashboard"))}),(e,a)=>{const r=j;return d(),t("div",ge,[a[0]||(a[0]=u("div",{class:"register-background"},null,-1)),u("div",fe,[u("div",_e,[f(l,{position:"top-right","tooltip-text":c(g)("register.theme_toggle_tooltip")},null,8,["tooltip-text"]),f(s,{position:"top-right","tooltip-text":c(g)("register.language_toggle_tooltip")},null,8,["tooltip-text"])])]),u("div",be,[u("div",ye,[u("div",Ce,[u("button",{onClick:w,class:"back-link"},[f(r,{class:"back-icon"},{default:_(()=>[f(c(U))]),_:1}),I(" "+v(c(g)("register.back_to_login")),1)])]),u("div",we,[u("h1",ke,v(c(g)("register.title")),1),u("p",he,v(c(g)("register.subtitle")),1)]),u("div",Ve,[f(me,{onSuccess:y,onError:C,loading:c(m).loading,inviteCode:b.value},null,8,["loading","inviteCode"])]),u("div",xe,[u("span",Ie,v(c(g)("register.has_account")),1),u("button",{onClick:w,class:"login-link"},v(c(g)("register.login_now")),1)]),c(m).error?(d(),t("div",Be,[f(r,{class:"error-icon"},{default:_(()=>[f(c(B))]),_:1}),u("span",null,v(c(m).error),1)])):n("",!0)])])])}}},[["__scopeId","data-v-b492965e"]]);export{je as default};
