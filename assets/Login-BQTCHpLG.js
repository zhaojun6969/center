import{_ as a,u as l,c as e,r as o,i as s,g as i,T as t,L as n,e as r}from"./index-DlA8SRM3.js";import{ax as d,r as c,f as u,z as g,A as p,aJ as v,B as m,L as _,P as b,u as h,c as w,j as f,E as y,K as k,ai as x,R as C,J as B,aK as L,I as z,W as j,l as I,aA as A,aB as D}from"./vendor-p2oL7ibe.js";import{G as E,E as G,H as M,I as S,J as q,K as F,L as H,M as O}from"./elementPlus-BlcbFMqO.js";import{u as J,m as K,r as P,e as T}from"./index-B5FtWS0I.js";import{L as U}from"./login-DyRwzpXs.js";const V=["disabled"],$={class:"button-text"},R={key:0},W={key:1},N={key:0,class:"loading-spinner"},Q=a({__name:"GoogleOAuthButton",props:{loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},code:{type:String,default:""}},emits:["success","error"],setup(a,{emit:e}){const i=l(),{t:t}=d(),n=e,r=a,w=c(!1),f=()=>new Promise((a,l)=>{if(window.google&&window.google.accounts&&window.google.accounts.id)return a();const e=document.createElement("script");e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.onload=()=>a(),e.onerror=a=>l(new Error("Google Identity Services 脚本加载失败")),document.head.appendChild(e)}),y=async()=>{if(w.value)return;w.value=!0,await f();window.google.accounts.id.initialize({client_id:"1087356879940-kcdvstc2pgoim27gffl67qrs297avdmb.apps.googleusercontent.com",callback:async a=>{const l=a&&a.credential;l?await k(l):errorMessage.value="未获取到 Google 身份凭证"}}),window.google.accounts.id.prompt()},k=async a=>{try{const l=await o.common(s.OAUTH_GOOGLE,{googleIdToken:a,inviteCode:r.code});let e=l.data;return void i.loginSuccess(e,()=>{n("success",l.data.user)})}catch(l){throw n("error",l),l}finally{w.value=!1}};return u(()=>{f()}),(l,e)=>(p(),g("button",{class:"google-oauth-button",disabled:a.loading||a.disabled,onClick:y},[e[0]||(e[0]=v('<div class="google-logo" data-v-c8832a21><svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg" data-v-c8832a21><path fill="#4285F4" d="M16.51 8.44c0-.62-.05-1.22-.15-1.8H8.98v3.4h4.05c-.17 1-.75 1.85-1.6 2.42v2.01h2.59c1.52-1.4 2.39-3.46 2.39-5.89z" data-v-c8832a21></path><path fill="#34A853" d="M8.98 17.5c2.43 0 4.47-.8 5.96-2.17l-2.59-2.01c-.8.54-1.83.86-2.99.86-2.3 0-4.24-1.55-4.93-3.64H2.18v2.07C3.99 15.95 6.26 17.5 8.98 17.5z" data-v-c8832a21></path><path fill="#FBBC05" d="M4.05 10.91c-.15-.54-.23-1.12-.23-1.91s.08-1.37.23-1.91V4.94H2.18C1.55 6.16 1.2 7.55 1.2 9s.35 2.84.98 4.06l2.87-2.15z" data-v-c8832a21></path><path fill="#EA4335" d="M8.98 4.18c1.17 0 2.22.4 3.06 1.18l2.3-2.3C13.46 1.8 11.41 1.2 8.98 1.2 6.26 1.2 3.99 2.75 2.18 4.94l2.87 2.15c.69-2.09 2.63-3.64 4.93-3.64z" data-v-c8832a21></path></svg></div>',1)),m("span",$,[a.loading?(p(),g("span",W,b(h(t)("login.google_logging")),1)):(p(),g("span",R,b(h(t)("login.google_login")),1))]),a.loading?(p(),g("div",N)):_("",!0)],8,V))}},[["__scopeId","data-v-c8832a21"]]),X={class:"form-group"},Y={class:"form-label",for:"email"},Z=["placeholder","disabled"],aa={key:0,class:"input-error-icon"},la={key:0,class:"error-message"},ea={class:"form-group"},oa={class:"form-label",for:"password"},sa=["type","placeholder","disabled"],ia=["disabled"],ta={key:0,class:"error-message"},na=["disabled"],ra={class:"button-text"},da={key:0},ca={key:1},ua={key:0,class:"loading-spinner"},ga={style:{"text-align":"center","font-size":"14px",cursor:"pointer"}},pa=["disabled"],va=a({__name:"LoginForm",props:{loading:{type:Boolean,default:!1}},emits:["login","error"],setup(a,{emit:l}){const{t:e}=d(),o=l,s=c({email:"",password:""}),i=c(!1),t=c(!1),n=c(!1),r=c(""),u=c(""),v={email:{required:P,email:T},password:{required:P,minLength:K(6)}},I=J(v,s),A=w(()=>s.value.email&&s.value.password&&!r.value&&!u.value),D=()=>{s.value.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.value.email)?r.value="":r.value=e("login.email_invalid_error"):r.value=e("login.email_empty_error")},q=()=>{s.value.password?s.value.password.length<6?u.value=e("login.password_min_error"):u.value="":u.value=e("login.password_empty_error")};f(()=>s.value.email,D),f(()=>s.value.password,q);const F=async()=>{if(await I.value.$validate(),I.value.$invalid)return D(),void q();o("login",s.value)};return(l,o)=>{const d=G;return p(),g("form",{class:"login-form",onSubmit:j(F,["prevent"])},[m("div",X,[m("label",Y,b(h(e)("login.email_label")),1),m("div",{class:y(["input-wrapper",{focused:i.value}])},[k(m("input",{id:"email","onUpdate:modelValue":o[0]||(o[0]=a=>s.value.email=a),type:"email",class:y(["form-input",{error:r.value}]),placeholder:h(e)("login.email_placeholder"),onFocus:o[1]||(o[1]=a=>i.value=!0),onBlur:o[2]||(o[2]=a=>i.value=!1),disabled:a.loading,autocomplete:"email"},null,42,Z),[[x,s.value.email]]),r.value?(p(),g("div",aa,[C(d,null,{default:B(()=>[C(h(E))]),_:1})])):_("",!0)],2),r.value?(p(),g("div",la,b(r.value),1)):_("",!0)]),m("div",ea,[m("label",oa,b(h(e)("login.password_label")),1),m("div",{class:y(["input-wrapper",{focused:t.value}])},[k(m("input",{id:"password","onUpdate:modelValue":o[3]||(o[3]=a=>s.value.password=a),type:n.value?"text":"password",class:y(["form-input",{error:u.value}]),placeholder:h(e)("login.password_placeholder"),onFocus:o[4]||(o[4]=a=>t.value=!0),onBlur:o[5]||(o[5]=a=>t.value=!1),disabled:a.loading,autocomplete:"current-password"},null,42,sa),[[L,s.value.password]]),m("button",{type:"button",class:"password-toggle",onClick:o[6]||(o[6]=a=>n.value=!n.value),disabled:a.loading},[n.value?(p(),z(d,{key:0},{default:B(()=>[C(h(M))]),_:1})):(p(),z(d,{key:1},{default:B(()=>[C(h(S))]),_:1}))],8,ia)],2),u.value?(p(),g("div",ta,b(u.value),1)):_("",!0)]),m("button",{type:"submit",class:"login-submit-button",disabled:a.loading||!A.value},[m("span",ra,[a.loading?(p(),g("span",ca,b(h(e)("login.email_logging")),1)):(p(),g("span",da,b(h(e)("login.email_login")),1))]),a.loading?(p(),g("div",ua)):_("",!0)],8,na),m("div",ga,[m("button",{type:"submit",class:"waitlist-button",disabled:a.loading||!A.value},b(h(e)("login.join_waitlist")),9,pa)]),_("",!0)],32)}}},[["__scopeId","data-v-a4c8d729"]]),ma={class:"login-page"},_a={class:"top-right-controls"},ba={class:"controls-container"},ha=["title"],wa={class:"login-container"},fa={class:"login-card"},ya={key:0,class:"google-login-section"},ka={key:1,class:"divider"},xa={class:"divider-text"},Ca={class:"email-login-section"},Ba={key:2,class:"error-message"},La={class:"auth-links"},za={class:"auth-links-row"},ja=a({__name:"Login",setup(a){const e=A(),o=l(),{t:s}=d(),v=I(new U);c(null),c(!0);const w=async a=>{v.login(a)},f=a=>{v.handleLoginSuccess(a)},y=D(),k=()=>{e.push("/")},x=()=>{e.push("/forgot-password")},L=()=>{e.push({name:"register",query:y.query})},z=()=>{e.replace("/login/phone")};return u(()=>{i()&&e.replace("/czhome")}),(a,l)=>{const e=G;return p(),g("div",ma,[l[2]||(l[2]=m("div",{class:"login-background"},null,-1)),m("div",_a,[m("div",ba,[m("button",{type:"button",class:"back-home-btn",onClick:k,title:h(s)("login.back_to_home")},[C(e,{class:"back-home-icon"},{default:B(()=>[C(h(q))]),_:1})],8,ha),C(t,{position:"top-right","tooltip-text":h(s)("login.theme_toggle_tooltip")},null,8,["tooltip-text"]),C(n,{position:"top-right","tooltip-text":h(s)("login.language_toggle_tooltip")},null,8,["tooltip-text"])])]),m("div",wa,[m("div",fa,[h(r).isDomesticDomain()?_("",!0):(p(),g("div",ya,[C(Q,{onSuccess:f,disabled:!1})])),h(r).isDomesticDomain()?_("",!0):(p(),g("div",ka,[l[0]||(l[0]=m("div",{class:"divider-line"},null,-1)),m("span",xa,b(h(s)("login.divider_text")),1),l[1]||(l[1]=m("div",{class:"divider-line"},null,-1))])),m("div",Ca,[C(va,{onLogin:w})]),h(o).error?(p(),g("div",Ba,[C(e,{class:"error-icon"},{default:B(()=>[C(h(E))]),_:1}),m("span",null,b(h(o).error),1)])):_("",!0),m("div",La,[m("div",za,[h(r).isDomesticDomain()?(p(),g("button",{key:0,type:"button",class:"auth-link phone-login-link",onClick:z},[C(e,{class:"link-icon"},{default:B(()=>[C(h(F))]),_:1}),m("span",null,b(h(s)("login.phone_login_link")),1)])):_("",!0),m("button",{type:"button",class:"auth-link forgot-password-link",onClick:x},[C(e,{class:"link-icon"},{default:B(()=>[C(h(H))]),_:1}),m("span",null,b(h(s)("login.forgot_password")),1)]),m("button",{type:"button",class:"auth-link register-link",onClick:L},[C(e,{class:"link-icon"},{default:B(()=>[C(h(O))]),_:1}),m("span",null,b(h(s)("login.register_account")),1)])])])])])])}}},[["__scopeId","data-v-66039a60"]]);export{ja as default};
