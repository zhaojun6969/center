import{_ as e}from"./index-DlA8SRM3.js";/* empty css                   */import{x as a,E as s,ak as i,Q as l,y as t,d}from"./elementPlus-BlcbFMqO.js";import{aA as c,ax as v,aB as n,r as o,c as u,f as r,z as m,A as p,B as f,R as g,J as y,O as L,P as h,u as _,L as b,Q as k,a5 as x}from"./vendor-p2oL7ibe.js";import{d as C}from"./date-CgH6eVIF.js";import{X as A}from"./xiaozhiserve-CNYrnHqQ.js";const D={class:"device-list"},j={class:"page-header"},w={class:"header-content"},z={class:"devices-section"},S={class:"devices-grid"},T={class:"device-card-body"},V={class:"device-info-item"},B={class:"label"},E={class:"value"},F={class:"device-info-item"},I={class:"label"},M={class:"value"},O={class:"device-info-item"},P={class:"label"},Q={class:"value"},R={class:"device-actions"},U={key:1,class:"loading-container"},G={class:"loading-text"},J={key:2,class:"loading-more-container"},N={class:"loading-more-text"},X={key:3,class:"no-more-container"},q={class:"no-more-text"},H={key:4,class:"empty-container"},K={class:"empty-content"},W={class:"empty-text"},Y={class:"unbind-dialog-content"},Z={class:"dialog-footer"},$=e({__name:"DeviceList",setup(e){const $=c(),{t:ee}=v(),ae=n(),se=new A,ie=o([]),le=o(!1),te=o(!0),de=u(()=>ae.params.agentId),ce=o(1),ve=o(10),ne=o(0),oe=o(!1),ue=o(""),re=async()=>{if(te.value&&!le.value)try{le.value=!0;const e=await se.deviceListAgent({agent_id:de.value,page:ce.value,page_size:ve.value});let a=[];0===e.code&&e.data&&(a=e.data.items||[],ne.value=e.data.total||0),1===ce.value?ie.value=a:ie.value=[...ie.value,...a],te.value=ie.value.length<ne.value,ce.value++}catch(e){}finally{le.value=!1}},me=()=>{re()},pe=()=>{oe.value=!1,ue.value=""},fe=async()=>{try{le.value=!0;const e=await se.unbindDeviceAgent({device_id:ue.value});0===e.code?(d.success(ee("deviceList.unbindSuccess")),ge()):d.error(e.msg||ee("deviceList.unbindFailed"))}catch(e){d.error(ee("deviceList.unbindFailed"))}finally{le.value=!1,oe.value=!1,ue.value=""}},ge=()=>{ce.value=1,le.value=!1,te.value=!0,ie.value=[],ne.value=0,re()},ye=()=>{$.back()};return r(()=>{ge()}),(e,d)=>{const c=a,v=s,n=l,o=t;return p(),m("div",D,[f("div",j,[f("div",w,[g(c,{type:"default",plain:"",onClick:ye},{default:y(()=>[L(h(_(ee)("common.back")),1)]),_:1})])]),d[1]||(d[1]=f("div",{style:{height:"10px",width:"100%"}},null,-1)),g(n,{height:"83vh",onEndReached:me},{default:y(()=>[f("div",z,[f("div",S,[ie.value.length>0?(p(!0),m(k,{key:0},x(ie.value,e=>(p(),m("div",{class:"device-card",key:e.id},[f("div",T,[f("div",V,[f("span",B,h(_(ee)("deviceList.macAddress"))+"：",1),f("span",E,h(e.mac_address||_(ee)("deviceList.notSet")),1)]),f("div",F,[f("span",I,h(_(ee)("deviceList.createdAt"))+"：",1),f("span",M,h(_(C).formatDateTime(e.created_at)||_(ee)("deviceList.notSet")),1)]),f("div",O,[f("span",P,h(_(ee)("deviceList.updatedAt"))+"：",1),f("span",Q,h(_(C).formatDateTime(e.updated_at)||_(ee)("deviceList.notSet")),1)]),f("div",R,[g(c,{type:"danger",size:"small",onClick:a=>{return s=e.id,ue.value=s,void(oe.value=!0);var s}},{default:y(()=>[L(h(_(ee)("deviceList.unbindDevice")),1)]),_:1},8,["onClick"])])])]))),128)):b("",!0),le.value&&0===ie.value.length?(p(),m("div",U,[f("div",G,h(_(ee)("deviceList.loading")),1)])):b("",!0),le.value&&ie.value.length>0?(p(),m("div",J,[f("div",N,h(_(ee)("deviceList.loadingMore")),1)])):b("",!0),!le.value&&!te.value.value&&ie.value.length>0?(p(),m("div",X,[f("div",q,h(_(ee)("deviceList.noMoreDevices")),1)])):b("",!0),le.value||0!==ie.value.length?b("",!0):(p(),m("div",H,[f("div",K,[g(v,{size:"64"},{default:y(()=>[g(_(i))]),_:1}),f("p",W,h(_(ee)("deviceList.noDevices")),1)])]))])])]),_:1}),g(o,{modelValue:oe.value,"onUpdate:modelValue":d[0]||(d[0]=e=>oe.value=e),title:_(ee)("deviceList.unbindConfirmTitle"),width:"400px",center:""},{footer:y(()=>[f("span",Z,[g(c,{onClick:pe},{default:y(()=>[L(h(_(ee)("common.cancel")),1)]),_:1}),g(c,{type:"danger",onClick:fe},{default:y(()=>[L(h(_(ee)("deviceList.confirmUnbind")),1)]),_:1})])]),default:y(()=>[f("div",Y,[f("p",null,h(_(ee)("deviceList.unbindConfirmContent")),1)])]),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-6f12146d"]]);export{$ as default};
