import{_ as e,F as t}from"./index-C1ozWA1l.js";/* empty css                   *//* empty css                     *//* empty css                 *//* empty css                 */import{y as a,E as r,R as s,z as i,as as n,J as l,T as u,ab as d,al as c,ae as o,at as g,au as f,D as m,A as h,d as p}from"./elementPlus-MWeHapXo.js";import{ax as v,r as $,f as y,l as M,c as C,al as w,z as b,A as _,B as D,R as S,P as k,I as U,J as x,O,u as T,Q as V,a5 as Y}from"./vendor-p2oL7ibe.js";import{G as H}from"./index-ZAMtcPP9.js";var F,L={exports:{}};const j=a((F||(F=1,L.exports=function(){var e=1e3,t=6e4,a=36e5,r="millisecond",s="second",i="minute",n="hour",l="day",u="week",d="month",c="quarter",o="year",g="date",f="Invalid Date",m=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,h=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],a=e%100;return"["+e+(t[(a-20)%10]||t[a]||t[0])+"]"}},v=function(e,t,a){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(a)+e},$={s:v,z:function(e){var t=-e.utcOffset(),a=Math.abs(t),r=Math.floor(a/60),s=a%60;return(t<=0?"+":"-")+v(r,2,"0")+":"+v(s,2,"0")},m:function e(t,a){if(t.date()<a.date())return-e(a,t);var r=12*(a.year()-t.year())+(a.month()-t.month()),s=t.clone().add(r,d),i=a-s<0,n=t.clone().add(r+(i?-1:1),d);return+(-(r+(a-s)/(i?s-n:n-s))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:d,y:o,w:u,d:l,D:g,h:n,m:i,s:s,ms:r,Q:c}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",M={};M[y]=p;var C="$isDayjsObject",w=function(e){return e instanceof S||!(!e||!e[C])},b=function e(t,a,r){var s;if(!t)return y;if("string"==typeof t){var i=t.toLowerCase();M[i]&&(s=i),a&&(M[i]=a,s=i);var n=t.split("-");if(!s&&n.length>1)return e(n[0])}else{var l=t.name;M[l]=t,s=l}return!r&&s&&(y=s),s||!r&&y},_=function(e,t){if(w(e))return e.clone();var a="object"==typeof t?t:{};return a.date=e,a.args=arguments,new S(a)},D=$;D.l=b,D.i=w,D.w=function(e,t){return _(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var S=function(){function p(e){this.$L=b(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[C]=!0}var v=p.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,a=e.utc;if(null===t)return new Date(NaN);if(D.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(m);if(r){var s=r[2]-1||0,i=(r[7]||"0").substring(0,3);return a?new Date(Date.UTC(r[1],s,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)):new Date(r[1],s,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)}}return new Date(t)}(e),this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return D},v.isValid=function(){return!(this.$d.toString()===f)},v.isSame=function(e,t){var a=_(e);return this.startOf(t)<=a&&a<=this.endOf(t)},v.isAfter=function(e,t){return _(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<_(e)},v.$g=function(e,t,a){return D.u(e)?this[t]:this.set(a,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var a=this,r=!!D.u(t)||t,c=D.p(e),f=function(e,t){var s=D.w(a.$u?Date.UTC(a.$y,t,e):new Date(a.$y,t,e),a);return r?s:s.endOf(l)},m=function(e,t){return D.w(a.toDate()[e].apply(a.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),a)},h=this.$W,p=this.$M,v=this.$D,$="set"+(this.$u?"UTC":"");switch(c){case o:return r?f(1,0):f(31,11);case d:return r?f(1,p):f(0,p+1);case u:var y=this.$locale().weekStart||0,M=(h<y?h+7:h)-y;return f(r?v-M:v+(6-M),p);case l:case g:return m($+"Hours",0);case n:return m($+"Minutes",1);case i:return m($+"Seconds",2);case s:return m($+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var a,u=D.p(e),c="set"+(this.$u?"UTC":""),f=(a={},a[l]=c+"Date",a[g]=c+"Date",a[d]=c+"Month",a[o]=c+"FullYear",a[n]=c+"Hours",a[i]=c+"Minutes",a[s]=c+"Seconds",a[r]=c+"Milliseconds",a)[u],m=u===l?this.$D+(t-this.$W):t;if(u===d||u===o){var h=this.clone().set(g,1);h.$d[f](m),h.init(),this.$d=h.set(g,Math.min(this.$D,h.daysInMonth())).$d}else f&&this.$d[f](m);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[D.p(e)]()},v.add=function(r,c){var g,f=this;r=Number(r);var m=D.p(c),h=function(e){var t=_(f);return D.w(t.date(t.date()+Math.round(e*r)),f)};if(m===d)return this.set(d,this.$M+r);if(m===o)return this.set(o,this.$y+r);if(m===l)return h(1);if(m===u)return h(7);var p=(g={},g[i]=t,g[n]=a,g[s]=e,g)[m]||1,v=this.$d.getTime()+r*p;return D.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,a=this.$locale();if(!this.isValid())return a.invalidDate||f;var r=e||"YYYY-MM-DDTHH:mm:ssZ",s=D.z(this),i=this.$H,n=this.$m,l=this.$M,u=a.weekdays,d=a.months,c=a.meridiem,o=function(e,a,s,i){return e&&(e[a]||e(t,r))||s[a].slice(0,i)},g=function(e){return D.s(i%12||12,e,"0")},m=c||function(e,t,a){var r=e<12?"AM":"PM";return a?r.toLowerCase():r};return r.replace(h,function(e,r){return r||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return D.s(t.$y,4,"0");case"M":return l+1;case"MM":return D.s(l+1,2,"0");case"MMM":return o(a.monthsShort,l,d,3);case"MMMM":return o(d,l);case"D":return t.$D;case"DD":return D.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return o(a.weekdaysMin,t.$W,u,2);case"ddd":return o(a.weekdaysShort,t.$W,u,3);case"dddd":return u[t.$W];case"H":return String(i);case"HH":return D.s(i,2,"0");case"h":return g(1);case"hh":return g(2);case"a":return m(i,n,!0);case"A":return m(i,n,!1);case"m":return String(n);case"mm":return D.s(n,2,"0");case"s":return String(t.$s);case"ss":return D.s(t.$s,2,"0");case"SSS":return D.s(t.$ms,3,"0");case"Z":return s}return null}(e)||s.replace(":","")})},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(r,g,f){var m,h=this,p=D.p(g),v=_(r),$=(v.utcOffset()-this.utcOffset())*t,y=this-v,M=function(){return D.m(h,v)};switch(p){case o:m=M()/12;break;case d:m=M();break;case c:m=M()/3;break;case u:m=(y-$)/6048e5;break;case l:m=(y-$)/864e5;break;case n:m=y/a;break;case i:m=y/t;break;case s:m=y/e;break;default:m=y}return f?m:D.a(m)},v.daysInMonth=function(){return this.endOf(d).$D},v.$locale=function(){return M[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var a=this.clone(),r=b(e,t,!0);return r&&(a.$L=r),a},v.clone=function(){return D.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},p}(),k=S.prototype;return _.prototype=k,[["$ms",r],["$s",s],["$m",i],["$H",n],["$W",l],["$M",d],["$y",o],["$D",g]].forEach(function(e){k[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),_.extend=function(e,t){return e.$i||(e(t,S,_),e.$i=!0),_},_.locale=b,_.isDayjs=w,_.unix=function(e){return _(1e3*e)},_.en=M[y],_.Ls=M,_.p={},_}()),L.exports)),W={class:"greeting-card-page"},A={class:"page-header"},I={class:"header-content"},z={class:"page-title"},B={class:"a1-series-tip"},P={class:"tip-card"},R={class:"tip-header"},q={class:"tip-title-section"},G={class:"tip-title"},J={class:"tip-subtitle"},E={class:"tip-features"},N={class:"tip-feature"},Z={class:"feature-content"},Q={class:"tip-feature"},K={class:"feature-content"},X={class:"tip-feature"},ee={class:"feature-content"},te={class:"main-content"},ae={class:"action-bar"},re={key:0,class:"card-grid"},se={class:"card-image-wrapper"},ie=["src"],ne={class:"card-overlay"},le={class:"card-date"},ue={class:"card-body"},de={class:"card-message"},ce={class:"card-actions"},oe=["src"],ge={key:1,class:"upload-placeholder"},fe={class:"upload-text"},me={class:"dialog-footer"},he={class:"delete-confirm-content"},pe={class:"delete-message"},ve={class:"dialog-footer"},$e=e({__name:"GreetingCard",setup(e){const a=new t,F=new H,{t:L,locale:$e}=v(),ye=$([]),Me=async()=>{try{const e=await F.getMyGreetingCardList();ye.value=e.rows.map(e=>({id:e.id,imageUrl:e.extraInfo.image.replace(/`/g,"").trim(),message:e.content,createTime:e.createdAt,cardMessage:e.extraInfo.cardMessage}))}catch(e){p.error(e.message||L("greetingCard.loadError"))}};y(()=>{Me()});const Ce=$(!1),we=$(!1),be=$(!1),_e=$(!1),De=$(!1),Se=$(null),ke=M({imageUrl:"",message:"",id:null,cardMessage:""}),Ue=$(null),xe=M({id:null,imageUrl:"",message:"",cardMessage:""}),Oe=C(()=>({imageUrl:[{required:!0,message:L("greetingCard.imageRequired"),trigger:"change"}],message:[{required:!0,message:L("greetingCard.messageRequired"),trigger:"blur"}],cardMessage:[{required:!0,message:L("greetingCard.cardMessageRequired"),trigger:"blur"}]})),Te=C(()=>"undefined"==typeof window?"500px":window.innerWidth<768?"90%":"500px"),Ve=C(()=>"undefined"==typeof window?"400px":window.innerWidth<768?"90%":"400px"),Ye=C(()=>"zh"===$e.value?150:200),He=C(()=>"zh"===$e.value?10:30),Fe=()=>{we.value=!1,xe.id=null,xe.imageUrl="",xe.message="",xe.cardMessage="",Ce.value=!0},Le=async()=>{if(Se.value)try{await F.deleteGreetingCard({id:Se.value}),ye.value=ye.value.filter(e=>e.id!==Se.value),p.success(L("greetingCard.deleteSuccess")),De.value=!1,Se.value=null}catch(e){p.error(e.message||L("greetingCard.deleteError"))}},je=e=>{const t=e.raw;if(!t)return;if(!t.type.startsWith("image/"))return void p.error("è¯·ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶");const r=new FileReader;r.onload=async e=>{const t=await a.uploadFile(e.target.result);xe.imageUrl=t,Ue.value&&Ue.value.validateField("imageUrl")},r.readAsDataURL(t)},We=async()=>{Ue.value&&await Ue.value.validate(async e=>{if(e){be.value=!0;try{we.value?(await F.updateGreetingCard({id:xe.id,content:xe.message,image:xe.imageUrl,cardMessage:xe.cardMessage}),p.success(L("greetingCard.updateSuccess"))):(await F.createGreetingCard({content:xe.message,image:xe.imageUrl,cardMessage:xe.cardMessage}),p.success(L("greetingCard.createSuccess"))),await Me(),be.value=!1,Ce.value=!1}catch(t){be.value=!1,p.error(t.message||L("greetingCard.saveError"))}}})};return(e,t)=>{const a=r,p=i,v=d,$=g,y=o,M=m,C=c,H=h,F=w("DtCardPreview");return _(),b("div",W,[D("div",A,[D("div",I,[D("h1",z,k(e.$t("greetingCard.pageTitle")),1),D("div",B,k(e.$t("greetingCard.a1SeriesTip")),1),D("div",P,[D("div",R,[D("div",q,[D("h3",G,k(e.$t("greetingCard.tipTitle")),1),D("p",J,k(e.$t("greetingCard.tipSubtitle")),1)])]),D("div",E,[D("div",N,[t[7]||(t[7]=D("div",{class:"feature-icon"},"ðŸŽ",-1)),D("div",Z,[D("h4",null,k(e.$t("greetingCard.tipFeatures.feature1.title")),1),D("p",null,k(e.$t("greetingCard.tipFeatures.feature1.description")),1)])]),D("div",Q,[t[8]||(t[8]=D("div",{class:"feature-icon"},"ðŸ“±",-1)),D("div",K,[D("h4",null,k(e.$t("greetingCard.tipFeatures.feature2.title")),1),D("p",null,k(e.$t("greetingCard.tipFeatures.feature2.description")),1)])]),D("div",X,[t[9]||(t[9]=D("div",{class:"feature-icon"},"ðŸ’",-1)),D("div",ee,[D("h4",null,k(e.$t("greetingCard.tipFeatures.feature3.title")),1),D("p",null,k(e.$t("greetingCard.tipFeatures.feature3.description")),1)])])])])])]),D("div",te,[D("div",ae,[S(p,{type:"primary",size:"large",class:"add-btn",onClick:Fe},{default:x(()=>[S(a,null,{default:x(()=>[S(T(s))]),_:1}),O("Â  "+k(e.$t("greetingCard.createButton")),1)]),_:1})]),ye.value.length>0?(_(),b("div",re,[(_(!0),b(V,null,Y(ye.value,t=>{return _(),b("div",{key:t.id,class:"greeting-card-item"},[D("div",se,[D("img",{src:t.imageUrl,alt:"Greeting Card Image",class:"card-image"},null,8,ie),D("div",ne,[D("span",le,k((r=t.createTime,j(r).format("YYYY-MM-DD HH:mm"))),1)])]),D("div",ue,[D("p",de,k(t.message),1),D("div",ce,[S(p,{type:"primary",class:"edit-btn",onClick:e=>(e=>{we.value=!0,xe.id=e.id,xe.imageUrl=e.imageUrl,xe.message=e.message,xe.cardMessage=e.cardMessage||"",Ce.value=!0})(t)},{default:x(()=>[S(a,null,{default:x(()=>[S(T(n))]),_:1}),O(" "+k(e.$t("greetingCard.editButton")),1)]),_:1},8,["onClick"]),S(p,{type:"primary",class:"preview-btn",onClick:e=>(e=>{ke.imageUrl=e.imageUrl,ke.message=e.message,ke.id=e.id,ke.cardMessage=e.cardMessage,_e.value=!0})(t)},{default:x(()=>[S(a,null,{default:x(()=>[S(T(l))]),_:1}),O(" "+k(e.$t("greetingCard.previewButton")),1)]),_:1},8,["onClick"]),S(p,{type:"danger",link:"",class:"action-btn",onClick:e=>(e=>{Se.value=e.id,De.value=!0})(t)},{default:x(()=>[S(a,null,{default:x(()=>[S(T(u))]),_:1}),O(" "+k(e.$t("greetingCard.deleteButton")),1)]),_:1},8,["onClick"])])])]);var r}),128))])):(_(),U(v,{key:1,description:e.$t("greetingCard.emptyTitle")+" "+e.$t("greetingCard.emptyDescription"),"image-size":200},null,8,["description"]))]),S(H,{modelValue:Ce.value,"onUpdate:modelValue":t[3]||(t[3]=e=>Ce.value=e),title:we.value?e.$t("greetingCard.dialogEditTitle"):e.$t("greetingCard.dialogCreateTitle"),width:Te.value,"custom-class":"custom-dialog","destroy-on-close":"","close-on-click-modal":!1,"close-on-press-escape":!0,"append-to-body":""},{footer:x(()=>[D("span",me,[S(p,{onClick:t[2]||(t[2]=e=>Ce.value=!1)},{default:x(()=>[O(k(e.$t("greetingCard.cancelButton")),1)]),_:1}),S(p,{type:"primary",class:"save-btn",onClick:We,loading:be.value},{default:x(()=>[O(k(e.$t("greetingCard.saveButton")),1)]),_:1},8,["loading"])])]),default:x(()=>[S(C,{model:xe,"label-position":"top",rules:Oe.value,ref_key:"formRef",ref:Ue},{default:x(()=>[S(y,{label:e.$t("greetingCard.imageUploadLabel"),prop:"imageUrl"},{default:x(()=>[S($,{class:"image-uploader",action:"#","auto-upload":!1,"show-file-list":!1,"on-change":je,accept:"image/*",drag:""},{default:x(()=>[xe.imageUrl?(_(),b("img",{key:0,src:xe.imageUrl.replace("draft-user.s3.us-east-2.amazonaws.com","dcts99982ui0s.cloudfront.net"),class:"uploaded-image"},null,8,oe)):(_(),b("div",ge,[S(a,{class:"upload-icon"},{default:x(()=>[S(T(f))]),_:1}),D("div",fe,k(e.$t("greetingCard.imageUploadPlaceholder")),1)]))]),_:1})]),_:1},8,["label"]),S(y,{label:e.$t("greetingCard.messageLabel"),prop:"message"},{default:x(()=>[S(M,{modelValue:xe.message,"onUpdate:modelValue":t[0]||(t[0]=e=>xe.message=e),type:"textarea",rows:4,placeholder:e.$t("greetingCard.messagePlaceholder"),maxlength:Ye.value,"show-word-limit":""},null,8,["modelValue","placeholder","maxlength"])]),_:1},8,["label"]),S(y,{label:e.$t("greetingCard.cardMessageLabel"),prop:"cardMessage"},{default:x(()=>[S(M,{modelValue:xe.cardMessage,"onUpdate:modelValue":t[1]||(t[1]=e=>xe.cardMessage=e),type:"textarea",rows:4,placeholder:e.$t("greetingCard.cardMessagePlaceholder"),maxlength:He.value,"show-word-limit":""},null,8,["modelValue","placeholder","maxlength"])]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title","width"]),S(H,{modelValue:De.value,"onUpdate:modelValue":t[5]||(t[5]=e=>De.value=e),width:Ve.value,"custom-class":"delete-confirm-dialog","destroy-on-close":"","close-on-click-modal":!1,"close-on-press-escape":!0,"append-to-body":"",center:""},{footer:x(()=>[D("span",ve,[S(p,{onClick:t[4]||(t[4]=e=>De.value=!1),class:"cancel-delete-btn"},{default:x(()=>[O(k(e.$t("greetingCard.cancelButton")),1)]),_:1}),S(p,{type:"danger",class:"confirm-delete-btn",onClick:Le},{default:x(()=>[O(k(e.$t("greetingCard.deleteButton")),1)]),_:1})])]),default:x(()=>[D("div",he,[D("p",pe,k(e.$t("greetingCard.deleteConfirm")),1)])]),_:1},8,["modelValue","width"]),S(F,{"card-message":ke.cardMessage,id:ke.id,modelValue:_e.value,"onUpdate:modelValue":t[6]||(t[6]=e=>_e.value=e),"image-url":ke.imageUrl,message:ke.message},null,8,["card-message","id","modelValue","image-url","message"])])}}},[["__scopeId","data-v-1d336513"]]);export{$e as default};
